

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installation &mdash; CONCEPT Documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  
    <link rel="canonical" href="https://jmd-dk.github.io/concept/installation.html"/>
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.js"></script>
        <script src="_static/sphinx_tabs/tabs.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Command-line options" href="command_line_options.html" />
    <link rel="prev" title="8. Using utilities" href="tutorial/utilities.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> CO<em>N</em>CEPT
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial/tutorial.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/installation.html">1. Effortless installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/first_simulations.html">2. Your first simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/parameter_files.html">3. Working with parameter files</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/gravity.html">4. Mastering gravity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/gravity.html#the-pm-method">4.1. The PM method</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/gravity.html#the-p3m-method">4.2. The P³M method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/output_types.html">5. Other kinds of output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/output_types.html#d-renders">5.1. 3D renders</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/output_types.html#id1">5.2. 2D renders</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/output_types.html#snapshots">5.3. Snapshots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/working_remotely.html">6. Working on remote clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/beyond_matter_only.html">7. Beyond matter-only simulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/beyond_matter_only.html#radiation">7.1. Radiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/beyond_matter_only.html#massive-neutrinos">7.2. Massive neutrinos</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/beyond_matter_only.html#dynamical-dark-energy">7.3. Dynamical dark energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/beyond_matter_only.html#decaying-cold-dark-matter">7.4. Decaying cold dark matter</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/beyond_matter_only.html#non-linear-massive-neutrinos">7.5. Non-linear massive neutrinos</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/utilities.html">8. Using utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/utilities.html#the-powerspec-and-render-utilities">8.1. The powerspec and render utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/utilities.html#the-class-utility">8.2. The CLASS utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/utilities.html#the-update-utility">8.3. The update utility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#supported-platforms">Supported platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#standard-installation">Standard installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#optimal-network-performance-on-clusters">Optimal network performance on clusters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cloning-with-git">Cloning with Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-installer-script-in-depth">The <code class="docutils literal notranslate"><span class="pre">installer</span></code> script in-depth</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#programs-installed">Programs installed</a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-line-options">Command-line options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#influential-environment-variables">Influential environment variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#making-use-of-pre-installed-libraries">Making use of pre-installed libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#specifying-dependency-versions">Specifying dependency versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#choosing-compiler-precedence">Choosing compiler precedence</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installing-mpich-or-openmpi">Installing MPICH or OpenMPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parallel-builds">Parallel builds</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-the-installer-to-install-specific-libraries-but-not-concept-itself">Using the <code class="docutils literal notranslate"><span class="pre">installer</span></code> to install specific libraries but not CO<em>N</em>CEPT itself</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#python-dependencies">Python dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-primary-dependencies">Other primary dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-dependencies">System dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-paths-and-env-files">The <code class="docutils literal notranslate"><span class="pre">.paths</span></code> and <code class="docutils literal notranslate"><span class="pre">.env</span></code> files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-paths-file">The <code class="docutils literal notranslate"><span class="pre">.paths</span></code> file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-env-file">The <code class="docutils literal notranslate"><span class="pre">.env</span></code> file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#path-like-environment-variables"><code class="docutils literal notranslate"><span class="pre">PATH</span></code>-like environment variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#eliminating-interference-from-foreign-python-installations">Eliminating interference from foreign Python installations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-mpi-executor">The <code class="docutils literal notranslate"><span class="pre">mpi_executor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-make-jobs-environment-variable">The <code class="docutils literal notranslate"><span class="pre">make_jobs</span></code> environment variable</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command_line_options.html">Command-line options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="command_line_options.html#basics">Basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#help-h-help">Help: <code class="docutils literal notranslate"><span class="pre">-h</span></code>, <code class="docutils literal notranslate"><span class="pre">--help</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#parameter-file-p-params">Parameter file: <code class="docutils literal notranslate"><span class="pre">-p</span></code>, <code class="docutils literal notranslate"><span class="pre">--params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#command-line-parameters-c-command-line-params">Command-line parameters: <code class="docutils literal notranslate"><span class="pre">-c</span></code>, <code class="docutils literal notranslate"><span class="pre">--command-line-params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#number-of-processes-n-nprocs">Number of processes: <code class="docutils literal notranslate"><span class="pre">-n</span></code>, <code class="docutils literal notranslate"><span class="pre">--nprocs</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="command_line_options.html#specifying-multiple-nodes">Specifying multiple nodes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#utility-u-utility">Utility: <code class="docutils literal notranslate"><span class="pre">-u</span></code>, <code class="docutils literal notranslate"><span class="pre">--utility</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#version-v-version">Version: <code class="docutils literal notranslate"><span class="pre">-v</span></code>, <code class="docutils literal notranslate"><span class="pre">--version</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="command_line_options.html#remote-job-submission">Remote job submission</a><ul>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#queue-q-queue">Queue: <code class="docutils literal notranslate"><span class="pre">-q</span></code>, <code class="docutils literal notranslate"><span class="pre">--queue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#wall-time-w-wall-time">Wall time: <code class="docutils literal notranslate"><span class="pre">-w</span></code>, <code class="docutils literal notranslate"><span class="pre">--wall-time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#memory-memory">Memory: <code class="docutils literal notranslate"><span class="pre">--memory</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#job-directive-j-job-directive">Job directive: <code class="docutils literal notranslate"><span class="pre">-j</span></code>, <code class="docutils literal notranslate"><span class="pre">--job-directive</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#no-watching-no-watching">No watching: <code class="docutils literal notranslate"><span class="pre">--no-watching</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="command_line_options.html#other-modes-of-building-running">Other modes of building/running</a><ul>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#local-local">Local: <code class="docutils literal notranslate"><span class="pre">--local</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#pure-python-pure-python">Pure Python: <code class="docutils literal notranslate"><span class="pre">--pure-python</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#no-optimizations-no-optimizations">No optimizations: <code class="docutils literal notranslate"><span class="pre">--no-optimizations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#native-optimizations-native-optimizations">Native optimizations: <code class="docutils literal notranslate"><span class="pre">--native-optimizations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#no-recompilation-no-recompilation">No recompilation: <code class="docutils literal notranslate"><span class="pre">--no-recompilation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#unsafe-building-unsafe-building">Unsafe building: <code class="docutils literal notranslate"><span class="pre">--unsafe-building</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="command_line_options.html#specials">Specials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#test-t-test">Test: <code class="docutils literal notranslate"><span class="pre">-t</span></code>, <code class="docutils literal notranslate"><span class="pre">--test</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#main-entry-point-m-main">Main entry point: <code class="docutils literal notranslate"><span class="pre">-m</span></code>, <code class="docutils literal notranslate"><span class="pre">--main</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#interactive-i-interactive">Interactive: <code class="docutils literal notranslate"><span class="pre">-i</span></code>, <code class="docutils literal notranslate"><span class="pre">--interactive</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parameters/parameters.html">Parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="parameters/input_output.html">Input/output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#initial-conditions"><code class="docutils literal notranslate"><span class="pre">initial_conditions</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#snapshot-type"><code class="docutils literal notranslate"><span class="pre">snapshot_type</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/numerical_parameters.html">Numerical parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/numerical_parameters.html#boxsize"><code class="docutils literal notranslate"><span class="pre">boxsize</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/cosmology.html">Cosmology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/cosmology.html#class-params"><code class="docutils literal notranslate"><span class="pre">class_params</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/physics.html">Physics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/physics.html#select-forces"><code class="docutils literal notranslate"><span class="pre">select_forces</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/simulation_options.html">Simulation options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation_options.html#t-base-background-factor"><code class="docutils literal notranslate"><span class="pre">Δt_base_background_factor</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/graphics.html">Graphics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/graphics.html#terminal-width"><code class="docutils literal notranslate"><span class="pre">terminal_width</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/system_of_units.html">System of units</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/system_of_units.html#unit-length"><code class="docutils literal notranslate"><span class="pre">unit_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/debugging_options.html">Debugging options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/debugging_options.html#print-load-imbalance"><code class="docutils literal notranslate"><span class="pre">print_load_imbalance</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utilities/utilities.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utilities/class.html">The CLASS utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/convert.html">The convert utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/gadget.html">The gadget utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/info.html">The info utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/play.html">The play utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/powerspec.html">The powerspec utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/render2D.html">The render2D utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/render3D.html">The render3D utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/update.html">The update utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/watch.html">The watch utility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="under_the_hood.html">Looking under the hood</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#installation-failed">Installation failed</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#compilation-failed">Compilation failed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#insufficient-memory">Insufficient memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#dangerous-optimizations">Dangerous optimizations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#terminal-color-output-looks-weird">Terminal color output looks weird</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#problems-related-to-python-libraries-and-packages">Problems related to Python libraries and packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#error-messages-containing-read-1">Error messages containing ‘Read -1’</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#the-simulation-hangs-when-calling-class">The simulation hangs when calling CLASS</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#crashes-or-other-bad-behavior">Crashes or other bad behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#problems-when-running-remotely">Problems when running remotely</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#choosing-an-mpi-executor">Choosing an MPI executor</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#different-hardware-architecture-on-front-end-and-remote-node">Different hardware architecture on front-end and remote node</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#it-still-does-not-work">It <em>still</em> does not work!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#bad-performance-when-using-multiple-processes-nodes">Bad performance when using multiple processes/nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#problems-when-using-multiple-nodes">Problems when using multiple nodes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="publications.html#theses">Theses</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CO<em>N</em>CEPT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Installation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/jmd-dk/concept/" class="fa fa-github"> Code Repository</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      

      
      

      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <style type="text/css">
  span.bolditalic {
    font-weight: bold;
    font-style: italic;
  }
</style><div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>This page contains detailed information about how to install CO<em>N</em>CEPT
along with its many dependencies. Unless you have some special need, it is
recommended to just follow the simple,
<a class="reference internal" href="#standard-installation"><span class="std std-ref">standard installation</span></a> instructions, including
those covering how to obtain
<a class="reference internal" href="#optimal-network-performance-on-clusters"><span class="std std-ref">optimal network performance</span></a>
if you intend to install CO<em>N</em>CEPT on a cluster.</p>
<p>The <a class="reference internal" href="#standard-installation"><span class="std std-ref">standard</span></a> way of installing CO<em>N</em>CEPT
utilizes the <code class="docutils literal notranslate"><span class="pre">installer</span></code> script to install CO<em>N</em>CEPT and all of its
dependencies. Many more details about how to use this script for more
customized installation is available under the
‘<a class="reference internal" href="#the-installer-script-in-depth"><span class="std std-ref">installer script in-depth</span></a>’ entry.</p>
<p>Though not recommended, you may choose to not make use of the <code class="docutils literal notranslate"><span class="pre">installer</span></code>
script, in which case you need to install all of the
<a class="reference internal" href="#dependencies"><span class="std std-ref">dependencies</span></a> yourself. After
<a class="reference external" href="https://github.com/jmd-dk/concept">downloading</a> the CO<em>N</em>CEPT source
code, you then need to
<a class="reference internal" href="#the-paths-and-env-files"><span class="std std-ref">specify environment information</span></a> by editing
the <code class="docutils literal notranslate"><span class="pre">.paths</span></code> and <code class="docutils literal notranslate"><span class="pre">.env</span></code> files.</p>
<p>Entries on this page:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#supported-platforms" id="id12">Supported platforms</a></p></li>
<li><p><a class="reference internal" href="#standard-installation" id="id13">Standard installation</a></p>
<ul>
<li><p><a class="reference internal" href="#optimal-network-performance-on-clusters" id="id14">Optimal network performance on clusters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cloning-with-git" id="id15">Cloning with Git</a></p></li>
<li><p><a class="reference internal" href="#the-installer-script-in-depth" id="id16">The <code class="docutils literal notranslate"><span class="pre">installer</span></code> script in-depth</a></p>
<ul>
<li><p><a class="reference internal" href="#programs-installed" id="id17">Programs installed</a></p></li>
<li><p><a class="reference internal" href="#command-line-options" id="id18">Command-line options</a></p></li>
<li><p><a class="reference internal" href="#influential-environment-variables" id="id19">Influential environment variables</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dependencies" id="id20">Dependencies</a></p>
<ul>
<li><p><a class="reference internal" href="#python-dependencies" id="id21">Python dependencies</a></p></li>
<li><p><a class="reference internal" href="#other-primary-dependencies" id="id22">Other primary dependencies</a></p></li>
<li><p><a class="reference internal" href="#system-dependencies" id="id23">System dependencies</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#the-paths-and-env-files" id="id24">The <code class="docutils literal notranslate"><span class="pre">.paths</span></code> and <code class="docutils literal notranslate"><span class="pre">.env</span></code> files</a></p>
<ul>
<li><p><a class="reference internal" href="#the-paths-file" id="id25">The <code class="docutils literal notranslate"><span class="pre">.paths</span></code> file</a></p></li>
<li><p><a class="reference internal" href="#the-env-file" id="id26">The <code class="docutils literal notranslate"><span class="pre">.env</span></code> file</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="supported-platforms">
<span id="id1"></span><h2><a class="toc-backref" href="#id12">Supported platforms</a><a class="headerlink" href="#supported-platforms" title="Permalink to this headline">¶</a></h2>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-0-0 docutils container">
<div class="docutils container">
<p><img alt="linux" src="_images/linux.png" style="height: 35px;" /> <span class="math notranslate nohighlight">\(\,\,\)</span> Linux</p>
</div>
</div>
<div class="item sphinx-data-tab-0-1 docutils container">
<div class="docutils container">
<p><img alt="windows" src="_images/windows.png" style="height: 35px;" /> <span class="math notranslate nohighlight">\(\,\,\)</span> Windows</p>
</div>
</div>
<div class="item sphinx-data-tab-0-2 docutils container">
<div class="docutils container">
<p><img alt="macos" src="_images/macos.png" style="height: 35px;" /> <span class="math notranslate nohighlight">\(\,\,\)</span> macOS</p>
</div>
</div>
<div class="item sphinx-data-tab-0-3 docutils container">
<div class="docutils container">
<p><img alt="docker" src="_images/docker.png" style="height: 35px;" /> <span class="math notranslate nohighlight">\(\,\,\)</span> Docker</p>
</div>
</div>
</div>
<div style="padding-bottom: 0;" class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-0-0 active docutils container">
<p>CO<em>N</em>CEPT should be <a class="reference internal" href="#standard-installation"><span class="std std-ref">trivial to install</span></a>
on all major Linux distributions. The system may be a laptop, a
workstation, a massively parallel computer cluster, a Raspberry Pi,
a virtual machine, etc.</p>
</div>
<div style="padding-bottom: 0;" class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-0-1 docutils container">
<p>Though CO<em>N</em>CEPT does not run natively on Windows, support is
obtained via the
<a class="reference external" href="https://docs.microsoft.com/en-us/windows/wsl/about">Windows Subsytem for Linux</a>.
If installing CO<em>N</em>CEPT on Windows this way, make sure to install it
into a proper Linux directory (e.g. your home directory <code class="docutils literal notranslate"><span class="pre">~</span></code>) and not a
Windows directory (e.g. <code class="docutils literal notranslate"><span class="pre">/mnt/c/...</span></code>).</p>
<p>The more traditional approach of installing Linux in a virtual machine
within Windows, or running CO<em>N</em>CEPT through Docker, of course works
too.</p>
</div>
<div style="padding-bottom: 0;" class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-0-2 docutils container">
<p>Currently the only means of running CO<em>N</em>CEPT on a mac are either to
install it within a virtual Linux machine or run it through Docker.</p>
<p>Though much of the POSIX infrastructure needed to install and run
CO<em>N</em>CEPT is available to macOS via <a class="reference external" href="https://brew.sh/">Homebrew</a>,
numerous incompatibilities between the GNU and BSD tools make the
porting to macOS non-trivial.</p>
</div>
<div style="padding-bottom: 0;" class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-0-3 docutils container">
<p>You may wish to run CO<em>N</em>CEPT through one of the provided
<a class="reference external" href="https://hub.docker.com/r/jmddk/concept/">Docker images</a>, freeing you
from the installation process entirely (assuming you have
<a class="reference external" href="https://www.docker.com/">Docker</a> already installed).</p>
<p>To start a Docker container based on the latest CO<em>N</em>CEPT Docker
image, do e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker run --rm -it -v <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span><span class="s2">&quot;</span>:/concept/concept/output jmddk/concept
</pre></div>
</div>
<p>Any files dumped in the CO<em>N</em>CEPT <code class="docutils literal notranslate"><span class="pre">output</span></code> directory will then
persist in your current directory after the Docker container is stopped.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you run Docker Desktop/Toolbox on Windows or macOS, some
configuration is needed for the mounting (<code class="docutils literal notranslate"><span class="pre">-v</span></code>) to actually point
to your native Windows/macOS directory.</p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>While running CO<em>N</em>CEPT via Docker is great for experimental use,
<a class="reference internal" href="#standard-installation"><span class="std std-ref">proper installation</span></a> on a Linux host is
preferable for running large simulations, ensuring maximum
performance.</p>
</div>
</div>
</div>
</div>
<div class="section" id="standard-installation">
<span id="id2"></span><h2><a class="toc-backref" href="#id13">Standard installation</a><a class="headerlink" href="#standard-installation" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to install CO<em>N</em>CEPT along with all of its dependencies is
to use the CO<em>N</em>CEPT <code class="docutils literal notranslate"><span class="pre">installer</span></code> Bash script. This script is part of the
CO<em>N</em>CEPT source code, and so if you have CO<em>N</em>CEPT already
<a class="reference external" href="https://github.com/jmd-dk/concept">downloaded</a>, you may find and run this
script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash installer
</pre></div>
</div>
<p>However, the simplest way to run the script is to just execute</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">concept_version</span><span class="o">=</span>master
bash &lt;<span class="o">(</span>wget -O- https://raw.githubusercontent.com/jmd-dk/concept/<span class="si">${</span><span class="nv">concept_version</span><span class="si">}</span>/installer<span class="o">)</span>
</pre></div>
</div>
<p>in a terminal, which will fetch and run the <code class="docutils literal notranslate"><span class="pre">installer</span></code> script directly from
the CO<em>N</em>CEPT GitHub repository, specifically the master version of the
script, which will install the corresponding master version of CO<em>N</em>CEPT.
Check out the CO<em>N</em>CEPT
<a class="reference external" href="https://github.com/jmd-dk/concept/releases">releases</a> for other available
release versions, or use <code class="docutils literal notranslate"><span class="pre">concept_version=master</span></code> for the absolute newest
(and unstable!) version.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The initial <code class="docutils literal notranslate"><span class="pre">bash</span></code> in the above commands is required regardless of your
shell</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Your system may fail to verify the certificate of the domain name
(<code class="docutils literal notranslate"><span class="pre">raw.githubusercontent.com</span></code>), causing <code class="docutils literal notranslate"><span class="pre">wget</span></code> to refuse the download.
If you encounter this issue, you can supply <code class="docutils literal notranslate"><span class="pre">--no-check-certificate</span></code> as a
further option to <code class="docutils literal notranslate"><span class="pre">wget</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the remainder of this page, we shall make us of the shorter
<code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">installer</span></code> syntax, but here the local file “<code class="docutils literal notranslate"><span class="pre">installer</span></code>” may
always be substituted with the online “<code class="docutils literal notranslate"><span class="pre">&lt;(wget</span> <span class="pre">...)</span></code>” version.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">installer</span></code> will prompt you for an installation directory, as well as
for permission to install each <a class="reference internal" href="#system-dependencies"><span class="std std-ref">system dependency</span></a>,
should any be missing. At the very beginning of the installation, a table of
software to be installed will be shown.</p>
<p>CO<em>N</em>CEPT along with all of the libraries it needs will be installed into
the chosen installation directory. To completely remove the CO<em>N</em>CEPT
installation, simply remove this directory.</p>
<p>The installation will take an hour or two on modern hardware and take up
about 1.5 GB of storage. Should the installation process end prematurely
(e.g. if you kill it yourself), simply rerun the installation command and it
will pick up from where it was.</p>
<div class="section" id="optimal-network-performance-on-clusters">
<span id="id3"></span><h3><a class="toc-backref" href="#id14">Optimal network performance on clusters</a><a class="headerlink" href="#optimal-network-performance-on-clusters" title="Permalink to this headline">¶</a></h3>
<p>To install CO<em>N</em>CEPT on a cluster, the standard installation procedure
above may be used. However, the performance of simulations running on multiple
processors may be very poor, as the MPI library installed by the <code class="docutils literal notranslate"><span class="pre">installer</span></code>
may not be configured optimally regarding the network and accompanying
software present on the cluster.</p>
<p>To test the network performance of MPI, you may simply run a small simulation
using 1, 2 and 4 processes. If the various timings printed out by the code
increases significantly as you increase the number of processes, you are
affected by this issue. Furthermore, running a simulation on 2 nodes each with
2 processes should not be significantly slower than running on a single node
with 4 processes, at least not if your cluster features a high-speed network
such as InfiniBand.</p>
<p>If you are affected by this issue, it is recommended to reinstall
CO<em>N</em>CEPT using an MPI library already present on the cluster, presumably
configured optimally by the system administrator. To do this, simply set the
<code class="docutils literal notranslate"><span class="pre">mpi_dir</span></code> variable to the directory containing this MPI library when
invoking the <code class="docutils literal notranslate"><span class="pre">installer</span></code>, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">mpi_dir</span><span class="o">=</span>/path/to/mpi bash installer
</pre></div>
</div>
<p>Note that you <em>will</em> have to reinstall CO<em>N</em>CEPT and its dependencies in
their entirety, if you want to swap out the MPI library.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you have <code class="docutils literal notranslate"><span class="pre">/path/to/mpi/bin</span></code> already in your <code class="docutils literal notranslate"><span class="pre">PATH</span></code> you may use
simply</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">mpi_dir</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>which mpicc<span class="k">)</span><span class="s2">&quot;</span> bash installer
</pre></div>
</div>
<p>Though <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">mpicc</span></code> does not evaluate exactly to <code class="docutils literal notranslate"><span class="pre">/path/to/mpi</span></code>, it
is close enough that the <code class="docutils literal notranslate"><span class="pre">installer</span></code> understands it.</p>
</div>
<p>For the MPI implementation, CO<em>N</em>CEPT officially supports MPICH and
OpenMPI, though it should not matter much (a CO<em>N</em>CEPT installation
using MVAPICH has been successful at least once). What is important is that
the MPI library used conforms to the MPI-3 (or MPI-3.1) standard.</p>
</div>
</div>
<div class="section" id="cloning-with-git">
<h2><a class="toc-backref" href="#id15">Cloning with Git</a><a class="headerlink" href="#cloning-with-git" title="Permalink to this headline">¶</a></h2>
<p>For installing CO<em>N</em>CEPT, cloning the code repository is not needed, as
a copy of the code (without Git history) is downloaded during
<a class="reference internal" href="#standard-installation"><span class="std std-ref">installation</span></a>.</p>
<p>If however you wish to work with a full clone of the CO<em>N</em>CEPT
<a class="reference external" href="https://github.com/jmd-dk/concept/">code repository</a>, the easiest way to do
so is to fist install the master version of CO<em>N</em>CEPT <em>without</em> Git,
following the
<a class="reference internal" href="#standard-installation"><span class="std std-ref">standard installation instructions</span></a>. Once
CO<em>N</em>CEPT is installed, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span></code> the online CO<em>N</em>CEPT repository
into a temporary directory and simply drop the <code class="docutils literal notranslate"><span class="pre">.git</span></code> subdirectory into the
root of your CO<em>N</em>CEPT installation.</p>
<p>The above can be achieved from the <code class="docutils literal notranslate"><span class="pre">concept</span></code> directory using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/jmd-dk/concept.git git
<span class="o">(</span><span class="nb">source</span> concept <span class="o">&amp;&amp;</span> mv git/.git <span class="nv">$top_dir</span>/<span class="o">)</span>
rm -rf git
</pre></div>
</div>
<p>If you now do a</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git status
</pre></div>
</div>
<p>it should detect changes to the <code class="docutils literal notranslate"><span class="pre">.paths</span></code> and <code class="docutils literal notranslate"><span class="pre">.env</span></code>
<a class="reference internal" href="#the-paths-and-env-files"><span class="std std-ref">files</span></a> only. These changes represent
customizations carried out during installation. You may commit these
changes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git commit -a -m <span class="s2">&quot;customized .paths and .env for </span><span class="k">$(</span>whoami<span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span></code> to another branch/tag/commit, your <code class="docutils literal notranslate"><span class="pre">.paths</span></code> and
<code class="docutils literal notranslate"><span class="pre">.env</span></code> files will be switched out for the ones in the online repository.
For CO<em>N</em>CEPT to run, you should then replace these with your own
versions (available on the <code class="docutils literal notranslate"><span class="pre">master</span></code> branch).</p>
</div>
</div>
<div class="section" id="the-installer-script-in-depth">
<span id="id4"></span><h2><a class="toc-backref" href="#id16">The <code class="docutils literal notranslate"><span class="pre">installer</span></code> script in-depth</a><a class="headerlink" href="#the-installer-script-in-depth" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">installer</span></code> script may be run with additional options or influential
environment variables, which can be used to e.g. request for a specific
version of a dependency to be installed, or to skip the installation of a
particular dependency and instead make use of a pre-installed version of the
same library. Before discussing such features, it is good to know exactly
what dependencies are installed.</p>
<div class="section" id="programs-installed">
<h3><a class="toc-backref" href="#id17">Programs installed</a><a class="headerlink" href="#programs-installed" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">installer</span></code> partitions all dependencies into <em>library</em> and <em>system</em>
dependencies. Unless explicitly specified, the <code class="docutils literal notranslate"><span class="pre">installer</span></code> installs all
library dependencies regardless of whether these already exist on the system.
The system dependencies consist of standard tools commonly installed
system-wide. If the <code class="docutils literal notranslate"><span class="pre">installer</span></code> detects a missing system dependency, it will
prompt for system-wide (root) installation through the package manager on the
system.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">installer</span></code> script is able to bootstrap itself up from just Bash, GNU
Core Utilities and a package manager (or just Bash and GNU Core Utilities if
all system dependencies are already present). In addition, it builds all
library dependencies from source, increasing the total number of dependencies
(as many dependencies have other dependencies, and so on). For the absolute
minimum dependency requirements needed to <em>run</em> CO<em>N</em>CEPT, see the
<a class="reference internal" href="#dependencies"><span class="std std-ref">Dependencies</span></a> entry.</p>
<p>The complete set of system dependencies needed/installed by the <code class="docutils literal notranslate"><span class="pre">installer</span></code>
is:</p>
<ul class="simple">
<li><p><strong>GNU tools</strong>: awk, grep, sed, gzip, tar, wget.</p></li>
<li><p><strong>Build tools</strong>: gcc, g++, gfortran, glibc, GNU make, as and ld (binutils),
Linux headers.</p></li>
</ul>
<p>The complete list of all library dependencies (and their dependency relations)
installed by the <code class="docutils literal notranslate"><span class="pre">installer</span></code> is given below:</p>
<ul class="simple">
<li><p><strong>zlib</strong></p></li>
<li><p><strong>FreeType</strong></p></li>
<li><p><strong>Perl</strong></p></li>
<li><p><strong>BLAS</strong> and <strong>LAPACK</strong></p></li>
<li><p><strong>MPI</strong></p></li>
<li><p><strong>FFTW 3</strong></p></li>
<li><p><strong>FFTW 2</strong></p></li>
<li><p><strong>ncurses</strong></p></li>
<li><p><strong>libffi</strong></p></li>
<li><p><strong>OpenSSL</strong> (depends on Perl)</p></li>
<li><p><strong>libpng</strong> (depends on zlib)</p></li>
<li><p><strong>GSL</strong> (depends on BLAS)</p></li>
<li><p><strong>HDF5</strong> (depends on zlib)</p></li>
<li><p><strong>GADGET</strong> (depends on MPI, GSL, FFTW 2)</p></li>
<li><p><strong>Python 3</strong> (depends on zlib)</p>
<ul>
<li><p><strong>pip</strong> (depends on OpenSSL, libffi), <strong>setuptools</strong> and <strong>wheel</strong>;
needed to install the Python packages below:</p>
<ul>
<li><p><strong>Blessings</strong> (depends on ncurses)</p></li>
<li><p><strong>Cython</strong></p></li>
<li><p><strong>CythonGSL</strong> (depends on Cython, GSL)</p></li>
<li><p><strong>NumPy</strong> (depends on BLAS, LAPACK)</p></li>
<li><p><strong>SciPy</strong> (depends on BLAS, LAPACK)</p></li>
<li><p><strong>Matplotlib</strong> (depends on libpng, FreeType)</p></li>
<li><p><strong>MPI4Py</strong> (depends on MPI, Cython)</p></li>
<li><p><strong>H5Py</strong> (depends on HDF5 and MPI)</p></li>
<li><p><strong>Sphinx</strong></p></li>
<li><p><strong>Sphinx-copybutton</strong> (depends on Sphinx)</p></li>
<li><p><strong>Sphinx_rtd_theme</strong> (depends on Sphinx)</p></li>
<li><p><strong>Sphinx-tabs</strong> (depends on Sphinx)</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>CLASS</strong> + <strong>classy</strong> (depends on Cython, NumPy)</p></li>
</ul>
<p>Finally, CO<em>N</em>CEPT itself depends on MPI, FFTW (3), GADGET, Python,
Blessings, Cython, CythonGSL, NumPy, SciPy, matplotlib, MPI4Py, H5Py, classy,
Sphinx, sphinx-copybutton, sphinx_rtd_theme, sphinx-tabs.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">installer</span></code> installs the
<a class="reference external" href="https://github.com/xianyi/OpenBLAS">OpenBLAS</a> library (which depends on
Perl) in order to provide both BLAS and LAPACK. For MPI,
<a class="reference external" href="https://www.mpich.org/">MPICH</a> (default) or
<a class="reference external" href="https://www.open-mpi.org/">OpenMPI</a> is installed (both depend on Perl). If
tests are to be performed during the installation (see the <code class="docutils literal notranslate"><span class="pre">--tests</span></code>
<a class="reference internal" href="#command-line-options"><span class="std std-ref">command-line option</span></a>), the pytest Python package
will be installed as well (needed for testing NumPy and SciPy).</p>
</div>
<div class="section" id="command-line-options">
<span id="id5"></span><h3><a class="toc-backref" href="#id18">Command-line options</a><a class="headerlink" href="#command-line-options" title="Permalink to this headline">¶</a></h3>
<p>When invoking the <code class="docutils literal notranslate"><span class="pre">installer</span></code> — whether a local copy or directly off of
GitHub — you may supply optional command-line arguments, the most useful of
which is probably the installation path. That is,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash installer /path/to/concept
</pre></div>
</div>
<p>will not prompt you for an installation directory but instead use the supplied
<code class="docutils literal notranslate"><span class="pre">/path/to/concept</span></code>.</p>
<p>Other command-line options to <code class="docutils literal notranslate"><span class="pre">installer</span></code> are listed below.</p>
<h6>
  Help:
  <code class="docutils literal notranslate"><span class="pre">
    -h
  </span></code>
  ,
  <code class="docutils literal notranslate"><span class="pre">
    --help
  </span></code>
</h6><p>This prints out a short description of how to use the <code class="docutils literal notranslate"><span class="pre">installer</span></code> script
and then exits. Generally though, this documentation page is much preferable.</p>
<h6>
  Tests:
  <code class="docutils literal notranslate"><span class="pre">
    -t
  </span></code>
  ,
  <code class="docutils literal notranslate"><span class="pre">
    --tests
  </span></code>
</h6><p>With this option, close to all dependency programs will be tested after their
individual installations. CO<em>N</em>CEPT itself will similarly be tested. On
failure (fatal or non-fatal) of any test, a log file of the test output will
be placed in the installation subdirectory of the given program. Any test
failures will be reported at the end of the entire installation process.</p>
<p>This option is helpful for debugging if it is known that the installation
results in a non-functioning CO<em>N</em>CEPT, but it is unknown which of the
many dependencies does not function correctly. Generally though, this option
is not recommended as it increases the installation time by a couple of hours.</p>
<p>The tests performed on the CO<em>N</em>CEPT code itself are those of</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./concept -t all
</pre></div>
</div>
<p>and so may also be run at any time after the installation, whether or not the
<code class="docutils literal notranslate"><span class="pre">--tests</span></code> option was used for th installation. See the <code class="docutils literal notranslate"><span class="pre">concept</span></code>
<a class="reference internal" href="command_line_options.html#test"><span class="std std-ref">test</span></a> option for further details.</p>
<h6>
  Yes to defaults:
  <code class="docutils literal notranslate"><span class="pre">
    -y
  </span></code>
  ,
  <code class="docutils literal notranslate"><span class="pre">
    --yes-to-defaults
  </span></code>
</h6><p>Assume “yes” as answer to all prompts (accept defaults) and run
non-interactively. These include system-wide installations of system
dependencies (should any be missing), which require root access.</p>
<h6>
  Native optimizations:
  <code class="docutils literal notranslate"><span class="pre">
    --native-optimizations
  </span></code>
</h6><p>This passes the
<a class="reference internal" href="command_line_options.html#native-optimizations"><span class="std std-ref">--native-optimizations flag</span></a> on to the
CO<em>N</em>CEPT compilation.</p>
<h6>
  Slim:
  <code class="docutils literal notranslate"><span class="pre">
    --slim
  </span></code>
</h6><p>This produces a trimmed down installation with uncritical content removed,
both from CO<em>N</em>CEPT itself and its dependency programs. This brings the
size of the installation down from about 1.5 GB to about 0.5 GB. Though
CO<em>N</em>CEPT itself remains fully functional in such a slim installation,
some features of the dependency programs will be broken. Debugging any issues
encountered will also generally be much harder.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The provided CO<em>N</em>CEPT <a class="reference internal" href="#supported-platforms"><span class="std std-ref">Docker images</span></a> are
built using a slim installation</p>
</div>
<p>Below we list the exact changes caused by the <code class="docutils literal notranslate"><span class="pre">--slim</span></code> option.</p>
<ul class="simple">
<li><p><strong>Fewer license and acknowledgement files</strong>: During normal installation, all
recognized license and acknowledgement files for the various dependencies
(and CO<em>N</em>CEPT itself) are copied over to the respective installation
directories. This is now skipped.</p></li>
<li><p><strong>Less documentation</strong>: Most documentation (full-blown documentation,
README’s, changelogs, etc.) for the dependency programs will be removed. The
documentation for CO<em>N</em>CEPT itself (these pages) will not be built but
remains available as source.</p></li>
<li><p><strong>Fewer example and test files</strong>: Example files demonstrating how to use the
various dependency programs, as well as test suites for demonstrating their
correctness, will be removed.</p></li>
<li><p><strong>Fewer configuration files</strong>: The majority of configuration files
describing the installation of the dependencies will be removed.</p></li>
<li><p><strong>No cached Python files</strong>: All bytecode files compiled and cached by Python
during installation will be removed.</p></li>
<li><p><strong>No compilation artifacts from CO</strong><span class="bolditalic">N</span><strong>CEPT and CLASS</strong>:
Only the final shared object files (as well as the bare source) resulting
from compilation of CO<em>N</em>CEPT and CLASS will be present after
installation.</p></li>
<li><p><strong>No symbols in binaries</strong>: The majority of all binary files will have their
symbol table stripped (for debug as well as other symbols).</p></li>
<li><p><strong>Fewer dependency programs</strong>: Some dependency programs are only strictly
needed during installation of the dependency stack, not for running
CO<em>N</em>CEPT itself. These will be completely removed. The dependencies in
question are: Perl, zlib.</p></li>
</ul>
<h6>
  Fix ssh:
  <code class="docutils literal notranslate"><span class="pre">
    --fix-ssh
  </span></code>
</h6><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do <em>not</em> use this option if you seek to install CO<em>N</em>CEPT</p>
</div>
<p>Invoking the installer with this option will not install CO<em>N</em>CEPT, but
instead attempt to configure the local <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code> directory of the user for
use with remote jobs running on multiple nodes, as described
<a class="reference internal" href="troubleshooting.html#problems-when-using-multiple-nodes"><span class="std std-ref">here</span></a>.</p>
</div>
<div class="section" id="influential-environment-variables">
<span id="id6"></span><h3><a class="toc-backref" href="#id19">Influential environment variables</a><a class="headerlink" href="#influential-environment-variables" title="Permalink to this headline">¶</a></h3>
<p>The behavior of the <code class="docutils literal notranslate"><span class="pre">installer</span></code> is governed by a large set of environment
variables. An example is the <code class="docutils literal notranslate"><span class="pre">mpi_dir</span></code> variable described in
‘<a class="reference internal" href="#optimal-network-performance-on-clusters"><span class="std std-ref">optimal network performance on clusters</span></a>’,
through which we can let the <code class="docutils literal notranslate"><span class="pre">installer</span></code> make use of a pre-installed MPI
library, rather than letting it install one itself. We can specify <code class="docutils literal notranslate"><span class="pre">mpi_dir</span></code>
either directly in the invocation of <code class="docutils literal notranslate"><span class="pre">installler</span></code>;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">mpi_dir</span><span class="o">=</span>/path/to/mpi bash installer
</pre></div>
</div>
<p>or defining it as an environmet variable prior to the invocation;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">mpi_dir</span><span class="o">=</span>/path/to/mpi  <span class="c1"># Assuming Bash-like shell</span>
bash installer
</pre></div>
</div>
<p>All other influential environment variables may be set in similar ways.</p>
<div class="section" id="making-use-of-pre-installed-libraries">
<h4>Making use of pre-installed libraries<a class="headerlink" href="#making-use-of-pre-installed-libraries" title="Permalink to this headline">¶</a></h4>
<p>To make the <code class="docutils literal notranslate"><span class="pre">installer</span></code> make use of a pre-installed library rather than
installing it itself, you must set the corresponding <code class="docutils literal notranslate"><span class="pre">*_dir</span></code> variable. The
complete list of such variables is: <code class="docutils literal notranslate"><span class="pre">blas_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">class_dir</span></code>,
<code class="docutils literal notranslate"><span class="pre">concept_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">fftw_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">fftw_for_gadget_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">freetype_dir</span></code>,
<code class="docutils literal notranslate"><span class="pre">gadget_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">gsl_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">hdf5_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">libffi_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">libpng_dir</span></code>,
<code class="docutils literal notranslate"><span class="pre">mpi_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">ncurses_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">openssl_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">perl_dir</span></code>,
<code class="docutils literal notranslate"><span class="pre">python_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">zlib_dir</span></code>.</p>
<p>Note that if using a pre-installed Python distribution —
<code class="docutils literal notranslate"><span class="pre">python_dir=/path/to/python</span></code> — OpenSSL, libffi and ncurses are assumed to
be already installed and build into the Python distribution, as these cannot
be tacked on after Python is build. Also, Python should come with at least pip
built-in. The <code class="docutils literal notranslate"><span class="pre">installer</span></code> will install any other missing Python packages.</p>
<p>If e.g. <code class="docutils literal notranslate"><span class="pre">mpi_dir</span></code> is set, the value of <code class="docutils literal notranslate"><span class="pre">mpi_version</span></code> is not used.</p>
</div>
<div class="section" id="specifying-dependency-versions">
<h4>Specifying dependency versions<a class="headerlink" href="#specifying-dependency-versions" title="Permalink to this headline">¶</a></h4>
<p>The version of each dependency (and CO<em>N</em>CEPT itself) to install is
specified near the top of the <code class="docutils literal notranslate"><span class="pre">installer</span></code> script (look for ‘Specification
of software versions’). You may direct the <code class="docutils literal notranslate"><span class="pre">installer</span></code> to use other versions
through the <code class="docutils literal notranslate"><span class="pre">*_version</span></code> variables. As with the <code class="docutils literal notranslate"><span class="pre">*_dir</span></code> variables, these
include <code class="docutils literal notranslate"><span class="pre">blas_version</span></code>, <code class="docutils literal notranslate"><span class="pre">class_version</span></code>, <code class="docutils literal notranslate"><span class="pre">concept_version</span></code>,
<code class="docutils literal notranslate"><span class="pre">fftw_version</span></code>, <code class="docutils literal notranslate"><span class="pre">fftw_for_gadget_version</span></code>, <code class="docutils literal notranslate"><span class="pre">freetype_version</span></code>,
<code class="docutils literal notranslate"><span class="pre">gadget_version</span></code>, <code class="docutils literal notranslate"><span class="pre">gsl_version</span></code>, <code class="docutils literal notranslate"><span class="pre">hdf5_version</span></code>, <code class="docutils literal notranslate"><span class="pre">libffi_version</span></code>,
<code class="docutils literal notranslate"><span class="pre">libpng_version</span></code>, <code class="docutils literal notranslate"><span class="pre">mpi_version</span></code>, <code class="docutils literal notranslate"><span class="pre">ncurses_version</span></code>, <code class="docutils literal notranslate"><span class="pre">openssl_version</span></code>,
<code class="docutils literal notranslate"><span class="pre">perl_version</span></code>, <code class="docutils literal notranslate"><span class="pre">python_version</span></code>, <code class="docutils literal notranslate"><span class="pre">zlib_version</span></code>. Furthermore, each
Python package also has a version, speficied by <code class="docutils literal notranslate"><span class="pre">blessings_version</span></code>,
<code class="docutils literal notranslate"><span class="pre">cython_version</span></code>, <code class="docutils literal notranslate"><span class="pre">cythongsl_version</span></code>, <code class="docutils literal notranslate"><span class="pre">h5py_version</span></code>,
<code class="docutils literal notranslate"><span class="pre">matplotlib_version</span></code>, <code class="docutils literal notranslate"><span class="pre">mpi4py_version</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy_version</span></code>,
<code class="docutils literal notranslate"><span class="pre">pip_version</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest_version</span></code>, <code class="docutils literal notranslate"><span class="pre">scipy_version</span></code>,
<code class="docutils literal notranslate"><span class="pre">setuptools_version</span></code>, <code class="docutils literal notranslate"><span class="pre">sphinx_version</span></code>, <code class="docutils literal notranslate"><span class="pre">sphinx_copybutton_version</span></code>,
<code class="docutils literal notranslate"><span class="pre">sphinx_rtd_theme_version</span></code>, <code class="docutils literal notranslate"><span class="pre">sphinx_tabs_version</span></code>, <code class="docutils literal notranslate"><span class="pre">wheel_version</span></code>.</p>
</div>
<div class="section" id="choosing-compiler-precedence">
<h4>Choosing compiler precedence<a class="headerlink" href="#choosing-compiler-precedence" title="Permalink to this headline">¶</a></h4>
<p>At the beginning of the installation, the <code class="docutils literal notranslate"><span class="pre">installer</span></code> will locate the
various compilers on the system. Its findings are presented under the
‘Compiler precedence’ heading. If the installation of a given program fails,
the <code class="docutils literal notranslate"><span class="pre">installer</span></code> moves on to the next compiler and tries again, and so on.
This is part of the overall philosophy of the <code class="docutils literal notranslate"><span class="pre">installer</span></code> to “try, try
again” if a particular choice of compiler/flags/etc. does not succeed. This is
one reason why the installation can be so time consuming. It does however make
the installation process very robust.</p>
<p>If you wish to have a say in the order in which the compilers are tried out,
you may define the <code class="docutils literal notranslate"><span class="pre">compiler_precedence</span></code> variable. To prefer e.g. Intel
compilers and then GNU compilers, set <code class="docutils literal notranslate"><span class="pre">compiler_precedence=&quot;intel</span> <span class="pre">gnu&quot;</span></code>.
Only compilers found on the system will be taken into account. Also, say the
system further has e.g. the Clang compiler, this will be tried out also, but
after any compilers specified in <code class="docutils literal notranslate"><span class="pre">compiler_precedence</span></code>.</p>
<p>The supported compilers — written in order of default precedence — are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">specified_mpi</span></code>: Use the compilers included in the MPI library
specified by <code class="docutils literal notranslate"><span class="pre">mpi_dir</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default</span></code>: Run as is, without altering the environment. If e.g. the <code class="docutils literal notranslate"><span class="pre">CC</span></code>
environment variable is set, this will probably be picked up by the
installation of the program.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gnu</span></code>: The GNU compilers (gcc, g++, gfortran).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clang</span></code>: The Clang compilers (clang, clang++).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mpi</span></code>: MPI compilers found on the system (mpicc, mpicxx, mpifort, …).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">intel</span></code>:  The Intel compilers (icc, icpc, ifort).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cray</span></code>: The Cray compilers (craycc, crayCC, crayftn).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">portland</span></code>: The Portland compilers (pgcc, pgCC, pgf77, pgf90).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">generic</span></code>: Non-specific compilers found on the system (cc, c++, fortran).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unset</span></code>: Explicitly unset environment variables such as <code class="docutils literal notranslate"><span class="pre">CC</span></code>, <code class="docutils literal notranslate"><span class="pre">CXX</span></code>,
<code class="docutils literal notranslate"><span class="pre">FC</span></code>.</p></li>
</ul>
<p>Many of the dependency programs do some compiler discovery of their own, and
so no guarantee of what compiler is actually used can be given.</p>
</div>
<div class="section" id="installing-mpich-or-openmpi">
<span id="id7"></span><h4>Installing MPICH or OpenMPI<a class="headerlink" href="#installing-mpich-or-openmpi" title="Permalink to this headline">¶</a></h4>
<p>If you let the <code class="docutils literal notranslate"><span class="pre">installer</span></code> install its own MPI library (i.e. leave
<code class="docutils literal notranslate"><span class="pre">mpi_dir</span></code> unspecified), you may choose between MPICH and OpenMPI by setting
either <code class="docutils literal notranslate"><span class="pre">mpi=mpich</span></code> or <code class="docutils literal notranslate"><span class="pre">mpi=openmpi</span></code>. If <code class="docutils literal notranslate"><span class="pre">mpi</span></code> is left unset, MPICH is
installed. Note that the same variable <code class="docutils literal notranslate"><span class="pre">mpi_version</span></code> thus refer to both the
version of MPICH and of OpenMPI.</p>
</div>
<div class="section" id="parallel-builds">
<h4>Parallel builds<a class="headerlink" href="#parallel-builds" title="Permalink to this headline">¶</a></h4>
<p>Much of the installation process can be sped up if we allow the make utility
to build in parallel. This is controlled through the <code class="docutils literal notranslate"><span class="pre">make_jobs</span></code> variable.
To enforce serial builds, set <code class="docutils literal notranslate"><span class="pre">make_jobs=&quot;-j</span> <span class="pre">1&quot;</span></code>. To enforce parallel builds
using e.g. 2 processors, specify <code class="docutils literal notranslate"><span class="pre">make_jobs=&quot;-j</span> <span class="pre">2&quot;</span></code>. You can also specify an
unlimited amount of available parallel processors using just
<code class="docutils literal notranslate"><span class="pre">make_jobs=&quot;-j&quot;</span></code>.</p>
<p>By default, when <code class="docutils literal notranslate"><span class="pre">make_jobs</span></code> is not specified, unlimited parallel builds are
used if installing locally, while serial builds are used if working remotely.</p>
</div>
<div class="section" id="using-the-installer-to-install-specific-libraries-but-not-concept-itself">
<h4>Using the <code class="docutils literal notranslate"><span class="pre">installer</span></code> to install specific libraries but not CO<em>N</em> CEPT itself<a class="headerlink" href="#using-the-installer-to-install-specific-libraries-but-not-concept-itself" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">installer</span></code> script may be used outside the context of CO<em>N</em>CEPT,
should you be in need of any of the dependencies for some other purpose. Which
programs to install is governed by <code class="docutils literal notranslate"><span class="pre">*_install</span></code> variables. By default,
<code class="docutils literal notranslate"><span class="pre">concept_install=True</span></code>, which in turn sets <code class="docutils literal notranslate"><span class="pre">*_install=True</span></code> for its
immidiate dependencies, which in turn sets <code class="docutils literal notranslate"><span class="pre">*_install=True</span></code> for their
dependencies, and so on. If you run the <code class="docutils literal notranslate"><span class="pre">installer</span></code> with
<code class="docutils literal notranslate"><span class="pre">concept_install=False</span></code>, nothing will be installed.</p>
<p>To install e.g. just FFTW, use</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">concept_install</span><span class="o">=</span>False <span class="nv">fftw_install</span><span class="o">=</span>True bash installer
</pre></div>
</div>
<p>possibly adding in a specific version (<code class="docutils literal notranslate"><span class="pre">fftw_version=...</span></code>) and an MPI
library (<code class="docutils literal notranslate"><span class="pre">mpi_dir=...</span></code> or <code class="docutils literal notranslate"><span class="pre">mpi_install=True</span></code>) to link against. As FFTW
does not absolutely need MPI, <code class="docutils literal notranslate"><span class="pre">mpi_install</span></code> is not set by having
<code class="docutils literal notranslate"><span class="pre">fftw_install=True</span></code>.</p>
<p>To install GADGET, use</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">concept_install</span><span class="o">=</span>False <span class="nv">gadget_install</span><span class="o">=</span>True bash installer
</pre></div>
</div>
<p>This time, MPI, GSL and FFTW (2) will be installed as well, as these are hard
dependencies.</p>
</div>
</div>
</div>
<div class="section" id="dependencies">
<span id="id8"></span><h2><a class="toc-backref" href="#id20">Dependencies</a><a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>This entry lists the dependency stack of CO<em>N</em>CEPT. Knowledge about this
stack is not needed if using the <code class="docutils literal notranslate"><span class="pre">installer</span></code> script (<em>highly</em> recommended!),
but it is important if for some reason you want to build (parts of) this stack
yourself.</p>
<p>Typically the exact version of any given dependency is not crucial. An effort
is made to ensure that CO<em>N</em>CEPT functions with the newest stable versions
of each dependency. As many of the CO<em>N</em>CEPT dependencies also depend on
each other, finding a working set of dependency versions may be non-trivial.
You may draw inspiration from the current or older versions of the
<a class="reference external" href="https://github.com/jmd-dk/concept/blob/master/installer">installation script</a>
(look for ‘Specification of software versions’).</p>
<div class="section" id="python-dependencies">
<h3><a class="toc-backref" href="#id21">Python dependencies</a><a class="headerlink" href="#python-dependencies" title="Permalink to this headline">¶</a></h3>
<p>The CO<em>N</em>CEPT source depends explicitly on
<a class="reference external" href="https://www.python.org/">Python</a> version 3.6 or newer, together with the
following Python packages (many of which have heavy dependencies of their
own):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cython.org/">Cython</a>: Needed for transpilation (<em>cythonization</em>)
of the pure Python source code of CO<em>N</em>CEPT into equivalent C code.</p></li>
<li><p><a class="reference external" href="https://www.numpy.org/">NumPy</a>: Provides the basic array types used for
representing all primary data, together with various array/math functions.</p></li>
<li><p><a class="reference external" href="https://www.scipy.org/">SciPy</a>: Provides various numerical methods and
additional math functions.</p></li>
<li><p><a class="reference external" href="https://matplotlib.org/">Matplotlib</a>: Provides plotting functionality for
2D and 3D figures, as well as color transformations used for colored
terminal output.</p></li>
<li><p><a class="reference external" href="https://mpi4py.readthedocs.io/">MPI4Py</a>: Provides Python bindings for
MPI, used for all inter-process communication.</p></li>
<li><p><a class="reference external" href="https://www.h5py.org/">H5Py</a>: Provides Python bindings for
<a class="reference external" href="https://www.hdfgroup.org/solutions/hdf5/">HDF5</a>, used for various binary
input/output.</p></li>
<li><p><a class="reference external" href="https://github.com/twiecki/CythonGSL">CythonGSL</a>: Provides Cython
bindings for <a class="reference external" href="https://www.gnu.org/software/gsl/">GSL</a>, used for more
performant replacements of some NumPy/SciPy functionalities when running
CO<em>N</em>CEPT in compiled mode.</p></li>
<li><p><a class="reference external" href="https://github.com/erikrose/blessings">Blessings</a>: Provides terminal
formatting.</p></li>
</ul>
<p>In addition, the <a class="reference external" href="http://www.sphinx-doc.org/">Sphinx</a>,
<a class="reference external" href="https://sphinx-copybutton.readthedocs.io/">sphinx-copybutton</a>,
<a class="reference external" href="https://sphinx-rtd-theme.readthedocs.io/">sphinx_rtd_theme</a> and
<a class="reference external" href="https://github.com/djungelorm/sphinx-tabs/">sphinx-tabs</a> Python packages
are needed to build the documentation, but may otherwise be left out.</p>
</div>
<div class="section" id="other-primary-dependencies">
<h3><a class="toc-backref" href="#id22">Other primary dependencies</a><a class="headerlink" href="#other-primary-dependencies" title="Permalink to this headline">¶</a></h3>
<p>In addition to Python, the Python packages listed above and their respective
dependencies, CO<em>N</em>CEPT further depends explicitly on
<a class="reference external" href="http://www.fftw.org/">FFTW</a> 3 for its distributed FFT capabilities.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CO<em>N</em>CEPT does not make use of the Python bindings
<a class="reference external" href="https://github.com/pyFFTW/pyFFTW">pyFFTW</a> for FFTW, as these do not
include the distributed (MPI) FFT’s needed. Instead, CO<em>N</em>CEPT provides
its own minimal wrapper, <code class="docutils literal notranslate"><span class="pre">fft.c</span></code>. This is the only C file in the primary
CO<em>N</em>CEPT source code.</p>
</div>
<p>If building FFTW yourself, remember to link against an MPI library. The same
goes for building HDF5 and installing MPI4Py and H5Py. Also, the MPI library
has to conform to the MPI-3 (or MPI-3.1) standard.</p>
<p>For testing, CO<em>N</em>CEPT compares itself against
<a class="reference external" href="https://wwwmpa.mpa-garching.mpg.de/gadget/">GADGET</a>, specifically version
2.0.7. When installing using the <code class="docutils literal notranslate"><span class="pre">installer</span></code> script, GADGET is patched in
order to increase the maximum allowed size of path names and slightly change
the values of various internal physical constants as to match the values
adopted by CO<em>N</em>CEPT. If you do not care about running the CO<em>N</em>CEPT
test suite, you do not have to install GADGET at all.</p>
<p>The last non-standard depenency of CO<em>N</em>CEPT is the
<a class="reference external" href="http://class-code.net/">CLASS</a> code, along with its Python wrapper
‘classy’. When installing using the <code class="docutils literal notranslate"><span class="pre">installer</span></code> script, CLASS and classy are
patched in order to enable larger and new kinds of output, fix bugs and
improve interoperability with CO<em>N</em>CEPT (which includes (slight) changes
to internal values of physical constants, to match the values adopted by
CO<em>N</em>CEPT). If installing without the use of the <code class="docutils literal notranslate"><span class="pre">installer</span></code> script, you
will have to obtain the patched CLASS + classy by some other means. A good
solution is to install everything else first, including CO<em>N</em>CEPT itself,
and then make use of the CO<em>N</em>CEPT <code class="docutils literal notranslate"><span class="pre">update</span></code> utility to install and patch
CLASS + classy:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./concept -u update --class &lt;version&gt;
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code> should be replaced with the CO<em>N</em>CEPT version whose
<code class="docutils literal notranslate"><span class="pre">installer</span></code> script should be used to install and patch CLASS + classy.</p>
</div>
<div class="section" id="system-dependencies">
<span id="id9"></span><h3><a class="toc-backref" href="#id23">System dependencies</a><a class="headerlink" href="#system-dependencies" title="Permalink to this headline">¶</a></h3>
<p>In addition to the many dependencies above, CO<em>N</em>CEPT further uses a lot
of <em>system dependencies</em>, by which is meant programs that are usually
installed system-wide. These include
<a class="reference external" href="https://www.gnu.org/software/bash/">Bash</a> 3.0 or newer, the
<a class="reference external" href="https://www.gnu.org/software/coreutils/">GNU Core Utilities</a> and the
<a class="reference external" href="https://www.gnu.org/software/findutils/">GNU Find Utilities</a>, which are the
only three that cannot be installed by the <code class="docutils literal notranslate"><span class="pre">installer</span></code>. The GNU Find
Utilities are only used for building the documentation and may be left out.
That said, all three of these system dependencies comes pre-installed on the
vast majority of Linux distributions.</p>
<p>Other system dependencies needed for the core CO<em>N</em>CEPT functionality are
awk, grep and sed. Also, the <code class="docutils literal notranslate"><span class="pre">installer</span></code> script and <code class="docutils literal notranslate"><span class="pre">update</span></code> utility
further makes use of gzip, tar and wget. That is, you may run simulations
without these last three components installed. If running the <code class="docutils literal notranslate"><span class="pre">installer</span></code>
script or <code class="docutils literal notranslate"><span class="pre">update</span></code> utility without these, you will be prompted for
system-wide (root) installation.</p>
<p>Lastly, CO<em>N</em>CEPT needs standard tools for compiling and linking C (C99)
code. An <code class="docutils literal notranslate"><span class="pre">mpicc</span></code> C compiler/linker should be bundled with the MPI library
used. The GNU make utility is also needed.</p>
</div>
</div>
<div class="section" id="the-paths-and-env-files">
<span id="id10"></span><h2><a class="toc-backref" href="#id24">The <code class="docutils literal notranslate"><span class="pre">.paths</span></code> and <code class="docutils literal notranslate"><span class="pre">.env</span></code> files</a><a class="headerlink" href="#the-paths-and-env-files" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">.paths</span></code> file and the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file are special files storing static
information about the CO<em>N</em>CEPT installation. The <code class="docutils literal notranslate"><span class="pre">.paths</span></code> file store
absolute paths to various files and directories, while the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file store
environment variables as they should be set when running CO<em>N</em>CEPT.</p>
<p>Both of these files are generated by the <code class="docutils literal notranslate"><span class="pre">installer</span></code> during installation.
Should you wish to not use the <code class="docutils literal notranslate"><span class="pre">installer</span></code>, you should grab <code class="docutils literal notranslate"><span class="pre">.paths</span></code> and
<code class="docutils literal notranslate"><span class="pre">.env</span></code> from the <a class="reference external" href="https://github.com/jmd-dk/concept">online repository</a> and
edit them manually.</p>
<div class="section" id="the-paths-file">
<h3><a class="toc-backref" href="#id25">The <code class="docutils literal notranslate"><span class="pre">.paths</span></code> file</a><a class="headerlink" href="#the-paths-file" title="Permalink to this headline">¶</a></h3>
<p>This is simply a Bash script of variable declarations, each variable storing
the absolute path to some file or directory. To install CO<em>N</em>CEPT without
the use of the <code class="docutils literal notranslate"><span class="pre">installer</span></code> script, you must manually set these paths.</p>
<p>From the comment above each variable, exactly what they refer to should be
obvious. An exception is the many <code class="docutils literal notranslate"><span class="pre">mpi_*</span></code> variables, which are explained
below:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mpi_dir</span></code> is the root directory for the MPI library, typically
containing the <code class="docutils literal notranslate"><span class="pre">bin</span></code>, <code class="docutils literal notranslate"><span class="pre">lib</span></code> and <code class="docutils literal notranslate"><span class="pre">include</span></code> subdirectories.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mpi_compilerdir</span></code> is the directory that contains the MPI C compiler,
<code class="docutils literal notranslate"><span class="pre">mpicc</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mpi_bindir</span></code> is the directory that contains the MPI executable
<code class="docutils literal notranslate"><span class="pre">mpiexec</span></code>/<code class="docutils literal notranslate"><span class="pre">mpirun</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mpi_libdir</span></code> is the directory that contains MPI library files, e.g.
<code class="docutils literal notranslate"><span class="pre">libmpi.so</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mpi_includedir</span></code> is the directory that contains MPI header files, e.g.
<code class="docutils literal notranslate"><span class="pre">mpi.h</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mpi_symlinkdir</span></code> is an optional directory in which to put symbolic links
to MPI library files not present (or present under non-standard names) in
<code class="docutils literal notranslate"><span class="pre">mpi_libdir</span></code>, but needed when linking MPI programs. You do  not have to
set this.</p></li>
</ul>
<p>In CO<em>N</em>CEPT parameter files, all variables defined in the <code class="docutils literal notranslate"><span class="pre">.paths</span></code>
file are available through the <code class="docutils literal notranslate"><span class="pre">paths</span></code> <code class="docutils literal notranslate"><span class="pre">dict</span></code>. Thus, to e.g. get the
absoute path to the <code class="docutils literal notranslate"><span class="pre">output</span></code> directory, you may use</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;output_dir&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>in your parameter file.</p>
<p>You are free to define further paths (or even variables in general) in the
<code class="docutils literal notranslate"><span class="pre">.paths</span></code> file, in which case they two will be available in parameter files
via the <code class="docutils literal notranslate"><span class="pre">paths</span></code> <code class="docutils literal notranslate"><span class="pre">dict</span></code>.</p>
</div>
<div class="section" id="the-env-file">
<h3><a class="toc-backref" href="#id26">The <code class="docutils literal notranslate"><span class="pre">.env</span></code> file</a><a class="headerlink" href="#the-env-file" title="Permalink to this headline">¶</a></h3>
<p>This file is meant to set up the needed environment variables needed for
building and running CO<em>N</em>CEPT. It is sourced by the <code class="docutils literal notranslate"><span class="pre">concept</span></code> script
before building and running the code.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Should you want the environment of your interactive shell to be populated
with the environment variables defined in <code class="docutils literal notranslate"><span class="pre">.env</span></code>, it is recommended to
source the <code class="docutils literal notranslate"><span class="pre">concept</span></code> script, rather than the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file. This is
becasue the <code class="docutils literal notranslate"><span class="pre">concept</span></code> scritp further sets up the environment in ways that
are not meant to be user defined. You may need to do this e.g. if
invoking <code class="docutils literal notranslate"><span class="pre">make</span></code> directly.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.env</span></code> file is populated with <code class="docutils literal notranslate"><span class="pre">PATH</span></code>-like environment variables
present during installation, if using the <code class="docutils literal notranslate"><span class="pre">installer</span></code>. On a cluster, you
typically source scripts or load modules prior to the installation itself in
order to gain access to compilers and/or libraries. The intend is for the
<code class="docutils literal notranslate"><span class="pre">.env</span></code> file to define all necessary environment variables, so that the same
sourcing or module loading does not have to be repeated manually before
running CO<em>N</em>CEPT.</p>
<p>If you are installing CO<em>N</em>CEPT without the use of the <code class="docutils literal notranslate"><span class="pre">installer</span></code> or
some crucial part of the environment was not picked up during the
installation, you may add it yourself to the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file, i.e. place</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span>
</pre></div>
</div>
<p>somewhere in <code class="docutils literal notranslate"><span class="pre">.env</span></code> to make the variable <code class="docutils literal notranslate"><span class="pre">name</span></code> with value <code class="docutils literal notranslate"><span class="pre">value</span></code> be
part of the global CO<em>N</em>CEPT environment.</p>
<div class="section" id="path-like-environment-variables">
<h4><code class="docutils literal notranslate"><span class="pre">PATH</span></code>-like environment variables<a class="headerlink" href="#path-like-environment-variables" title="Permalink to this headline">¶</a></h4>
<p>Many environment variables (e.g. <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code>) are
“<code class="docutils literal notranslate"><span class="pre">PATH</span></code>-like”, meaning that their values are colon-separated substrings.
Such environment variables are potentially dangerous to overwrite, so
instead they are merely updated by either prepending or appending new
substrings to their present value, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;/some/new/path:</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># prepending</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">:/some/new/path&quot;</span>  <span class="c1"># appending</span>
</pre></div>
</div>
<p>The above syntax is allowed in <code class="docutils literal notranslate"><span class="pre">.env</span></code>. Equivalently, the
<code class="docutils literal notranslate"><span class="pre">pathenv_name_value_pairs_custom</span></code> array variable may be used;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">pathenv_name_value_pairs_custom</span><span class="o">=(</span>PATH <span class="s2">&quot;/some/new/path&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>which either prepends or appends <code class="docutils literal notranslate"><span class="pre">/some/new/path</span></code> to <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, depending on
whether the <code class="docutils literal notranslate"><span class="pre">concatenate</span></code> variable in <code class="docutils literal notranslate"><span class="pre">.env</span></code> is set to <code class="docutils literal notranslate"><span class="pre">prepend</span></code> or
<code class="docutils literal notranslate"><span class="pre">append</span></code>.</p>
<p>When using the <code class="docutils literal notranslate"><span class="pre">installer</span></code>, any such <code class="docutils literal notranslate"><span class="pre">PATH</span></code>-like environment variables
present during install time will be placed in a similar array structure.
Whether these are prepended or appended to the preexisting values of the same
<code class="docutils literal notranslate"><span class="pre">PATH</span></code>-like environment variables when building/running CO<em>N</em>CEPT is
similarly determined by <code class="docutils literal notranslate"><span class="pre">concatenate</span></code>.</p>
</div>
<div class="section" id="eliminating-interference-from-foreign-python-installations">
<span id="id11"></span><h4>Eliminating interference from foreign Python installations<a class="headerlink" href="#eliminating-interference-from-foreign-python-installations" title="Permalink to this headline">¶</a></h4>
<p>When using the <code class="docutils literal notranslate"><span class="pre">installer</span></code> and Python is installed as part of the
CO<em>N</em>CEPT installation (the default), the following lines are placed in
<code class="docutils literal notranslate"><span class="pre">.env</span></code> (see the
<a class="reference external" href="https://docs.python.org/3/using/cmdline.html#environment-variables">Python documentation</a>
for details):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">unset</span> PYTHONPATH
<span class="nb">unset</span> PYTHONHOME
<span class="nb">export</span> <span class="nv">PYTHONNOUSERSITE</span><span class="o">=</span><span class="s2">&quot;True&quot;</span>
</pre></div>
</div>
<p>This is to eliminate any chance of interference from other Python
installations on the system. If you have installed CO<em>N</em>CEPT manually and
experience problems with Python (e.g. <code class="docutils literal notranslate"><span class="pre">ImportError</span></code>), try adding the above
lines to the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file yourself.</p>
</div>
<div class="section" id="the-mpi-executor">
<h4>The <code class="docutils literal notranslate"><span class="pre">mpi_executor</span></code><a class="headerlink" href="#the-mpi-executor" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">mpi_executor</span></code> variable determines which program is resonsible for
launching CO<em>N</em>CEPT as an MPI program, when submitted as a job on a remote
cluster. You may leave this empty or undefined in which case a (hopefully)
suitable value will be determined by the <code class="docutils literal notranslate"><span class="pre">concept</span></code> script.</p>
<p>After submitting a remote CO<em>N</em>CEPT job, see the <code class="docutils literal notranslate"><span class="pre">jobscript</span></code> for the
chosen value of <code class="docutils literal notranslate"><span class="pre">mpi_executor</span></code>.</p>
<p>See <a class="reference internal" href="troubleshooting.html#chosing-an-mpi-executor"><span class="std std-ref">this</span></a> troubleshooting entry for further
details.</p>
</div>
<div class="section" id="the-make-jobs-environment-variable">
<h4>The <code class="docutils literal notranslate"><span class="pre">make_jobs</span></code> environment variable<a class="headerlink" href="#the-make-jobs-environment-variable" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">make_jobs</span></code> variable is not present in the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file by default, but
may be set in order to specify whether CO<em>N</em>CEPT should be built in
parallel. The default behavior is to build in parallel when working locally
and serially when working remotely. To overrule this, add one of e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">make_jobs</span><span class="o">=</span><span class="s2">&quot;-j 1&quot;</span>  <span class="c1"># Always build serially</span>
<span class="nb">export</span> <span class="nv">make_jobs</span><span class="o">=</span><span class="s2">&quot;-j 2&quot;</span>  <span class="c1"># Always build in parallel, using 2 cores</span>
<span class="nb">export</span> <span class="nv">make_jobs</span><span class="o">=</span><span class="s2">&quot;-j&quot;</span>    <span class="c1"># Always build in parallel, using any number of cores</span>
</pre></div>
</div>
<p>to <code class="docutils literal notranslate"><span class="pre">.env</span></code>.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      

      
      

      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>