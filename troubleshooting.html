<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Troubleshooting &mdash; CONCEPT Documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="canonical" href="https://jmd-dk.github.io/concept/troubleshooting.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/tabs.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Publications" href="publications.html" />
    <link rel="prev" title="watch utility" href="utilities/watch.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CO<em>N</em>CEPT
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search documentation" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial/tutorial.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/installation.html">1. Effortless installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/first_simulations.html">2. Your first simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/parameter_files.html">3. Working with parameter files</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/gravity.html">4. Mastering gravity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/gravity.html#the-pm-method">4.1. The PM method</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/gravity.html#the-p3m-method">4.2. The P³M method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/output_types.html">5. Other kinds of output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/output_types.html#bispectra">5.1. Bispectra</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/output_types.html#d-renders">5.2. 3D renders</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/output_types.html#id1">5.3. 2D renders</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/output_types.html#snapshots">5.4. Snapshots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/working_remotely.html">6. Working on remote clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/beyond_matter_only.html">7. Beyond matter-only simulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/beyond_matter_only.html#radiation">7.1. Radiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/beyond_matter_only.html#massive-neutrinos">7.2. Massive neutrinos</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/beyond_matter_only.html#dynamical-dark-energy">7.3. Dynamical dark energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/beyond_matter_only.html#decaying-cold-dark-matter">7.4. Decaying cold dark matter</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/beyond_matter_only.html#non-linear-massive-neutrinos">7.5. Non-linear massive neutrinos</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/bispectra.html">8. Bispectra and 2LPT</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/gadget.html">9. Comparison with GADGET-2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#supported-platforms">Supported platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#standard-installation">Standard installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#optimal-network-performance-on-clusters">Optimal network performance on clusters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#cloning-with-git">Cloning with Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#the-install-script-in-depth">The <code class="docutils literal notranslate"><span class="pre">install</span></code> script in-depth</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#programs-installed">Programs installed</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#command-line-options">Command-line options</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#influential-environment-variables">Influential environment variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="installation.html#making-use-of-pre-installed-libraries">Making use of pre-installed libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#specifying-dependency-versions">Specifying dependency versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#specifying-dependency-urls">Specifying dependency URLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#choosing-compiler-precedence">Choosing compiler precedence</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#installing-mpich-or-openmpi">Installing MPICH or OpenMPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#parallel-builds">Parallel builds</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#using-the-install-script-to-install-specific-libraries-but-not-concept-itself">Using the <code class="docutils literal notranslate"><span class="pre">install</span></code> script to install specific libraries but not CO<em>N</em>CEPT itself</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#dependencies">Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#python-dependencies">Python dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#other-primary-dependencies">Other primary dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#system-dependencies">System dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#the-path-and-env-files">The <code class="docutils literal notranslate"><span class="pre">.path</span></code> and <code class="docutils literal notranslate"><span class="pre">.env</span></code> files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#the-path-file">The <code class="docutils literal notranslate"><span class="pre">.path</span></code> file</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#the-env-file">The <code class="docutils literal notranslate"><span class="pre">.env</span></code> file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="installation.html#path-like-environment-variables"><code class="docutils literal notranslate"><span class="pre">PATH</span></code>-like environment variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#eliminating-interference-from-foreign-python-installations">Eliminating interference from foreign Python installations</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#the-mpi-executor">The <code class="docutils literal notranslate"><span class="pre">mpi_executor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#the-make-jobs-environment-variable">The <code class="docutils literal notranslate"><span class="pre">make_jobs</span></code> environment variable</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command_line_options.html">Command-line options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="command_line_options.html#basics">Basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#help-h-help">Help: <code class="docutils literal notranslate"><span class="pre">-h</span></code>, <code class="docutils literal notranslate"><span class="pre">--help</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#parameter-file-p-param">Parameter file: <code class="docutils literal notranslate"><span class="pre">-p</span></code>, <code class="docutils literal notranslate"><span class="pre">--param</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#command-line-parameters-c-command-line-params">Command-line parameters: <code class="docutils literal notranslate"><span class="pre">-c</span></code>, <code class="docutils literal notranslate"><span class="pre">--command-line-params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#number-of-processes-n-nprocs">Number of processes: <code class="docutils literal notranslate"><span class="pre">-n</span></code>, <code class="docutils literal notranslate"><span class="pre">--nprocs</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="command_line_options.html#specifying-multiple-nodes">Specifying multiple nodes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#utility-u-utility">Utility: <code class="docutils literal notranslate"><span class="pre">-u</span></code>, <code class="docutils literal notranslate"><span class="pre">--utility</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="command_line_options.html#remote-job-submission">Remote job submission</a><ul>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#submit-submit">Submit: <code class="docutils literal notranslate"><span class="pre">--submit</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#queue-q-queue">Queue: <code class="docutils literal notranslate"><span class="pre">-q</span></code>, <code class="docutils literal notranslate"><span class="pre">--queue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#wall-time-w-walltime">Wall time: <code class="docutils literal notranslate"><span class="pre">-w</span></code>, <code class="docutils literal notranslate"><span class="pre">--walltime</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#memory-memory">Memory: <code class="docutils literal notranslate"><span class="pre">--memory</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#job-name-job-name">Job name: <code class="docutils literal notranslate"><span class="pre">--job-name</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#job-directive-j-job-directive">Job directive: <code class="docutils literal notranslate"><span class="pre">-j</span></code>, <code class="docutils literal notranslate"><span class="pre">--job-directive</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#watch-watch">Watch: <code class="docutils literal notranslate"><span class="pre">--watch</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="command_line_options.html#building-and-running">Building and running</a><ul>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#local-local">Local: <code class="docutils literal notranslate"><span class="pre">--local</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#pure-python-pure-python">Pure Python: <code class="docutils literal notranslate"><span class="pre">--pure-python</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#build-b-build">Build: <code class="docutils literal notranslate"><span class="pre">-b</span></code>, <code class="docutils literal notranslate"><span class="pre">--build</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#rebuild-rebuild">Rebuild: <code class="docutils literal notranslate"><span class="pre">--rebuild</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#optimizations-optimizations">Optimizations: <code class="docutils literal notranslate"><span class="pre">--optimizations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#link-time-optimizations-linktime-optimizations">Link time optimizations: <code class="docutils literal notranslate"><span class="pre">--linktime-optimizations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#native-optimizations-native-optimizations">Native optimizations: <code class="docutils literal notranslate"><span class="pre">--native-optimizations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#safe-build-safe-build">Safe build: <code class="docutils literal notranslate"><span class="pre">--safe-build</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="command_line_options.html#specials">Specials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#test-t-tests">Test: <code class="docutils literal notranslate"><span class="pre">-t</span></code>, <code class="docutils literal notranslate"><span class="pre">--tests</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#main-entry-point-m-main">Main entry point: <code class="docutils literal notranslate"><span class="pre">-m</span></code>, <code class="docutils literal notranslate"><span class="pre">--main</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#interactive-i-interactive">Interactive: <code class="docutils literal notranslate"><span class="pre">-i</span></code>, <code class="docutils literal notranslate"><span class="pre">--interactive</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="command_line_options.html#version-v-version">Version: <code class="docutils literal notranslate"><span class="pre">-v</span></code>, <code class="docutils literal notranslate"><span class="pre">--version</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parameters/parameters.html">Parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="parameters/input_output.html">Input/output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#initial-conditions"><code class="docutils literal notranslate"><span class="pre">initial_conditions</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#output-dirs"><code class="docutils literal notranslate"><span class="pre">output_dirs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#output-bases"><code class="docutils literal notranslate"><span class="pre">output_bases</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#output-times"><code class="docutils literal notranslate"><span class="pre">output_times</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#autosave-interval"><code class="docutils literal notranslate"><span class="pre">autosave_interval</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#snapshot-select"><code class="docutils literal notranslate"><span class="pre">snapshot_select</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#powerspec-select"><code class="docutils literal notranslate"><span class="pre">powerspec_select</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#bispec-select"><code class="docutils literal notranslate"><span class="pre">bispec_select</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#render2d-select"><code class="docutils literal notranslate"><span class="pre">render2D_select</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#render3d-select"><code class="docutils literal notranslate"><span class="pre">render3D_select</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#snapshot-type"><code class="docutils literal notranslate"><span class="pre">snapshot_type</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#gadget-snapshot-params"><code class="docutils literal notranslate"><span class="pre">gadget_snapshot_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#snapshot-wrap"><code class="docutils literal notranslate"><span class="pre">snapshot_wrap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#select-particle-id"><code class="docutils literal notranslate"><span class="pre">select_particle_id</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#class-plot-perturbations"><code class="docutils literal notranslate"><span class="pre">class_plot_perturbations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#class-extra-background"><code class="docutils literal notranslate"><span class="pre">class_extra_background</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/input_output.html#class-extra-perturbations"><code class="docutils literal notranslate"><span class="pre">class_extra_perturbations</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/numerics.html">Numerics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/numerics.html#boxsize"><code class="docutils literal notranslate"><span class="pre">boxsize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/numerics.html#potential-options"><code class="docutils literal notranslate"><span class="pre">potential_options</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/numerics.html#shortrange-params"><code class="docutils literal notranslate"><span class="pre">shortrange_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/numerics.html#powerspec-options"><code class="docutils literal notranslate"><span class="pre">powerspec_options</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/numerics.html#bispec-options"><code class="docutils literal notranslate"><span class="pre">bispec_options</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/numerics.html#bispec-antialiasing"><code class="docutils literal notranslate"><span class="pre">bispec_antialiasing</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/numerics.html#class-dedicated-spectra"><code class="docutils literal notranslate"><span class="pre">class_dedicated_spectra</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/numerics.html#class-modes-per-decade"><code class="docutils literal notranslate"><span class="pre">class_modes_per_decade</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/cosmology.html">Cosmology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/cosmology.html#h0"><code class="docutils literal notranslate"><span class="pre">H0</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/cosmology.html#b"><code class="docutils literal notranslate"><span class="pre">Ωb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/cosmology.html#cdm"><code class="docutils literal notranslate"><span class="pre">Ωcdm</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/cosmology.html#a-begin"><code class="docutils literal notranslate"><span class="pre">a_begin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/cosmology.html#t-begin"><code class="docutils literal notranslate"><span class="pre">t_begin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/cosmology.html#primordial-spectrum"><code class="docutils literal notranslate"><span class="pre">primordial_spectrum</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/cosmology.html#class-params"><code class="docutils literal notranslate"><span class="pre">class_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/cosmology.html#enable-class-background"><code class="docutils literal notranslate"><span class="pre">enable_class_background</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/physics.html">Physics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/physics.html#select-forces"><code class="docutils literal notranslate"><span class="pre">select_forces</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/physics.html#select-species"><code class="docutils literal notranslate"><span class="pre">select_species</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/physics.html#realization-options"><code class="docutils literal notranslate"><span class="pre">realization_options</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/physics.html#select-lives"><code class="docutils literal notranslate"><span class="pre">select_lives</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/physics.html#softening-kernel"><code class="docutils literal notranslate"><span class="pre">softening_kernel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/physics.html#select-softening-length"><code class="docutils literal notranslate"><span class="pre">select_softening_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/simulation.html">Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#t-base-background-factor"><code class="docutils literal notranslate"><span class="pre">Δt_base_background_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#t-base-nonlinear-factor"><code class="docutils literal notranslate"><span class="pre">Δt_base_nonlinear_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#t-increase-max-factor"><code class="docutils literal notranslate"><span class="pre">Δt_increase_max_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#t-rung-factor"><code class="docutils literal notranslate"><span class="pre">Δt_rung_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#a-max-early"><code class="docutils literal notranslate"><span class="pre">Δa_max_early</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#a-max-late"><code class="docutils literal notranslate"><span class="pre">Δa_max_late</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#static-timestepping"><code class="docutils literal notranslate"><span class="pre">static_timestepping</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#n-rungs"><code class="docutils literal notranslate"><span class="pre">N_rungs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#fftw-wisdom-rigor"><code class="docutils literal notranslate"><span class="pre">fftw_wisdom_rigor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#fftw-wisdom-reuse"><code class="docutils literal notranslate"><span class="pre">fftw_wisdom_reuse</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#fftw-wisdom-share"><code class="docutils literal notranslate"><span class="pre">fftw_wisdom_share</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#random-seeds"><code class="docutils literal notranslate"><span class="pre">random_seeds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#primordial-noise-imprinting"><code class="docutils literal notranslate"><span class="pre">primordial_noise_imprinting</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#primordial-amplitude-fixed"><code class="docutils literal notranslate"><span class="pre">primordial_amplitude_fixed</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#primordial-phase-shift"><code class="docutils literal notranslate"><span class="pre">primordial_phase_shift</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#cell-centered"><code class="docutils literal notranslate"><span class="pre">cell_centered</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#class-k-max"><code class="docutils literal notranslate"><span class="pre">class_k_max</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/simulation.html#class-reuse"><code class="docutils literal notranslate"><span class="pre">class_reuse</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/graphics.html">Graphics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/graphics.html#terminal-width"><code class="docutils literal notranslate"><span class="pre">terminal_width</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/graphics.html#enable-terminal-formatting"><code class="docutils literal notranslate"><span class="pre">enable_terminal_formatting</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/graphics.html#render2d-options"><code class="docutils literal notranslate"><span class="pre">render2D_options</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/graphics.html#render3d-options"><code class="docutils literal notranslate"><span class="pre">render3D_options</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/units.html">Units</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/units.html#unit-length"><code class="docutils literal notranslate"><span class="pre">unit_length</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/units.html#unit-time"><code class="docutils literal notranslate"><span class="pre">unit_time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/units.html#unit-mass"><code class="docutils literal notranslate"><span class="pre">unit_mass</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters/debugging.html">Debugging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters/debugging.html#print-load-imbalance"><code class="docutils literal notranslate"><span class="pre">print_load_imbalance</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/debugging.html#particle-reordering"><code class="docutils literal notranslate"><span class="pre">particle_reordering</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters/debugging.html#enable-hubble"><code class="docutils literal notranslate"><span class="pre">enable_Hubble</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utilities/utilities.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utilities/class.html">class utility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utilities/class.html#basic-usage">Basic usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities/class.html#command-line-options">Command-line options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="utilities/class.html#help-h-help">Help: <code class="docutils literal notranslate"><span class="pre">-h</span></code>, <code class="docutils literal notranslate"><span class="pre">--help</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="utilities/class.html#minimum-fourier-mode-kmin">Minimum Fourier mode: <code class="docutils literal notranslate"><span class="pre">--kmin</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="utilities/class.html#maximum-fourier-mode-kmax">Maximum Fourier mode: <code class="docutils literal notranslate"><span class="pre">--kmax</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="utilities/class.html#fourier-modes-modes">Fourier modes: <code class="docutils literal notranslate"><span class="pre">--modes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="utilities/class.html#times-times">Times: <code class="docutils literal notranslate"><span class="pre">--times</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="utilities/class.html#gauge-gauge">Gauge: <code class="docutils literal notranslate"><span class="pre">--gauge</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utilities/class.html#file-contents">File contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="utilities/class.html#data-layout">Data layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="utilities/class.html#extra-output">Extra output</a></li>
<li class="toctree-l4"><a class="reference internal" href="utilities/class.html#units">Units</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utilities/class.html#complete-example-massive-neutrinos">Complete example (massive neutrinos)</a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities/class.html#running-through-docker">Running through Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities/class.html#tips-and-tricks">Tips and tricks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utilities/convert.html">convert utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/gadget.html">gadget utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/info.html">info utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/play.html">play utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/powerspec.html">powerspec utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/bispec.html">bispec utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/render3D.html">render3D utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/update.html">update utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities/watch.html">watch utility</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation-failed">Installation failed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compilation-failed">Compilation failed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#insufficient-memory">Insufficient memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dangerous-optimizations">Dangerous optimizations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#terminal-colour-output-looks-weird">Terminal colour output looks weird</a></li>
<li class="toctree-l2"><a class="reference internal" href="#problems-related-to-python-libraries-and-packages">Problems related to Python libraries and packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#error-messages-containing-read-1">Error messages containing ‘Read -1’</a></li>
<li class="toctree-l2"><a class="reference internal" href="#clock-skew-and-or-modification-times-in-the-future">Clock skew and/or modification times in the future</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mixed-compiled-and-pure-python-mode">Mixed compiled and pure Python mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-simulation-hangs-when-calling-class">The simulation hangs when calling CLASS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#crashes-or-other-bad-behaviour">Crashes or other bad behaviour</a></li>
<li class="toctree-l2"><a class="reference internal" href="#problems-when-running-remotely">Problems when running remotely</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#choosing-an-mpi-executor">Choosing an MPI executor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#different-hardware-architecture-on-front-end-and-remote-node">Different hardware architecture on front-end and remote node</a></li>
<li class="toctree-l3"><a class="reference internal" href="#it-still-does-not-work">It <em>still</em> does not work!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#bad-performance-when-using-multiple-processes-nodes">Bad performance when using multiple processes/nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#problems-when-using-multiple-nodes">Problems when using multiple nodes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="publications.html#theses">Theses</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CO<em>N</em>CEPT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Troubleshooting</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/jmd-dk/concept/" class="fa fa-github"> Code Repository</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">


  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="troubleshooting">
<h1>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this heading"></a></h1>
<p>This page contains solutions to and helpful information about possible issues
encountered when using CO<em>N</em>CEPT. If help from this page is insufficient
to solve your problem, do not hesitate to
<a class="reference external" href="https://github.com/jmd-dk/concept/issues">open an issue</a> or contact the
author at
<span class="raw-html"><td class="field-body"><a class="reference external" href="mailto:dakin&#37;&#52;&#48;phys&#46;au&#46;dk">dakin<span>&#64;</span>phys<span>&#46;</span>au<span>&#46;</span>dk</a></td></span>.</p>
<p>Entries on this page:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#installation-failed" id="id5">Installation failed</a></p></li>
<li><p><a class="reference internal" href="#compilation-failed" id="id6">Compilation failed</a></p></li>
<li><p><a class="reference internal" href="#terminal-colour-output-looks-weird" id="id7">Terminal colour output looks weird</a></p></li>
<li><p><a class="reference internal" href="#problems-related-to-python-libraries-and-packages" id="id8">Problems related to Python libraries and packages</a></p></li>
<li><p><a class="reference internal" href="#error-messages-containing-read-1" id="id9">Error messages containing ‘Read -1’</a></p></li>
<li><p><a class="reference internal" href="#clock-skew-and-or-modification-times-in-the-future" id="id10">Clock skew and/or modification times in the future</a></p></li>
<li><p><a class="reference internal" href="#mixed-compiled-and-pure-python-mode" id="id11">Mixed compiled and pure Python mode</a></p></li>
<li><p><a class="reference internal" href="#the-simulation-hangs-when-calling-class" id="id12">The simulation hangs when calling CLASS</a></p></li>
<li><p><a class="reference internal" href="#crashes-or-other-bad-behaviour" id="id13">Crashes or other bad behaviour</a></p></li>
<li><p><a class="reference internal" href="#problems-when-running-remotely" id="id14">Problems when running remotely</a></p></li>
<li><p><a class="reference internal" href="#bad-performance-when-using-multiple-processes-nodes" id="id15">Bad performance when using multiple processes/nodes</a></p></li>
<li><p><a class="reference internal" href="#problems-when-using-multiple-nodes" id="id16">Problems when using multiple nodes</a></p></li>
</ul>
</nav>
<section id="installation-failed">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Installation failed</a><a class="headerlink" href="#installation-failed" title="Permalink to this heading"></a></h2>
<p>We strive for a trivial installation process on as many Linux systems as
possible. If the
<a class="reference internal" href="installation.html#standard-installation"><span class="std std-ref">standard installation process</span></a>
(with every dependency allowed to be installed from scratch) keeps failing
for some inexplicable reason, you may try looking for a clue in the logged
installation output (of which there are a lot), in the <code class="docutils literal notranslate"><span class="pre">.tmp/install_log</span></code>
and <code class="docutils literal notranslate"><span class="pre">.tmp/install_log_err</span></code> files, with the <code class="docutils literal notranslate"><span class="pre">.tmp</span></code> directory located within
the installation directory.</p>
<p>One possible source of trouble is corrupted downloads. The <code class="docutils literal notranslate"><span class="pre">install</span></code> script
downloads the source code of every primary dependency into the
<code class="docutils literal notranslate"><span class="pre">.tmp</span></code> directory. If you suspect a corrupt download, you can try deleting
subdirectories within this directory, which will trigger re-downloads.</p>
<p>It may happen that some dependency program fails to install due to some other
dependency not working correctly. You may try adding the <code class="docutils literal notranslate"><span class="pre">--tests</span></code>
<a class="reference internal" href="installation.html#command-line-options"><span class="std std-ref">option</span></a>
when invoking the <code class="docutils literal notranslate"><span class="pre">install</span></code> script, which tests the vast majority of the
dependency programs after/during their individual installation. Carefully
looking through the installation log files for failed tests may then
reveal something.</p>
<p>If several compilers are found on the system, different compilers may be used
for building different dependencies, which can cause issues. For the best
chances for a successful installation, try setting GNU (GCC) as the
<a class="reference internal" href="installation.html#choosing-compiler-precedence"><span class="std std-ref">preferred compiler</span></a>,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">compiler_precedence</span><span class="o">=</span><span class="s2">&quot;gnu&quot;</span>
</pre></div>
</div>
<p>and then redo the CO<em>N</em>CEPT installation from scratch.</p>
</section>
<section id="compilation-failed">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Compilation failed</a><a class="headerlink" href="#compilation-failed" title="Permalink to this heading"></a></h2>
<p>Compilation of the CO<em>N</em>CEPT code takes place as the last essential step
during <a class="reference internal" href="installation.html#standard-installation"><span class="std std-ref">standard installation</span></a>, as well as when
invoking <code class="docutils literal notranslate"><span class="pre">concept</span></code> after changes have been made to the source files. This
process may fail for several reasons, solutions to some are described in this
entry.</p>
<p>To check whether the problem is confined to the compilation process, run the
code in pure Python mode. From within the CO<em>N</em>CEPT installation
directory, do</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./concept<span class="w"> </span>--pure-python<span class="w"> </span>--local
</pre></div>
</div>
<p>If this simple invocation of <code class="docutils literal notranslate"><span class="pre">concept</span></code> fails, the problem is not with the
compilation process itself, in which case this troubleshooting entry cannot
help you.</p>
<section id="insufficient-memory">
<span id="id1"></span><h3>Insufficient memory<a class="headerlink" href="#insufficient-memory" title="Permalink to this heading"></a></h3>
<p>The minimum memory needed in order for compilation of the code to succeed is
about 3 GB, though the exact number depends on the system. If you suspect the
cause of compilation errors might be insufficient memory, try out the below
steps from within the CO<em>N</em>CEPT installation directory.</p>
<ul>
<li><p>Standard (parallel) compilation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./concept<span class="w"> </span>--rebuild<span class="w"> </span>--local
</pre></div>
</div>
</li>
<li><p>Compile each module in serial:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">make_jobs</span><span class="o">=</span><span class="s2">&quot;-j 1&quot;</span><span class="w"> </span>./concept<span class="w"> </span>--rebuild<span class="w"> </span>--local
</pre></div>
</div>
</li>
<li><p>Add extra swap memory: If you have root privileges on the system, you can
temporarily increase the available memory by adding a swap file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">n</span><span class="o">=</span><span class="m">8</span>
sudo<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>/dev/zero<span class="w"> </span><span class="nv">of</span><span class="o">=</span>swapfile<span class="w"> </span><span class="nv">bs</span><span class="o">=</span><span class="m">1024</span><span class="w"> </span><span class="nv">count</span><span class="o">=</span><span class="k">$((</span><span class="nv">n</span><span class="o">*</span><span class="m">2</span><span class="o">**</span><span class="m">20</span><span class="k">))</span>
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>swapfile
sudo<span class="w"> </span>mkswap<span class="w"> </span>swapfile
sudo<span class="w"> </span>swapon<span class="w"> </span>swapfile
</pre></div>
</div>
<p>This will add an additional 8 GB of swap memory (taken from available disk
space), which is plenty. If you do not have that much free disk space, you
may try with a lower value of <code class="docutils literal notranslate"><span class="pre">n</span></code>. With this increased amount of memory,
try compiling the code again. If it still fails even when compiling
serially, insufficient memory is probably not the problem. To clean up the
swap file, do</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>swapoff<span class="w"> </span>swapfile
sudo<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>swapfile
</pre></div>
</div>
</li>
</ul>
<p>After successful compilation, CO<em>N</em>CEPT will run just as performant as had
the compilation taken place without trouble.</p>
</section>
<section id="dangerous-optimizations">
<span id="id2"></span><h3>Dangerous optimizations<a class="headerlink" href="#dangerous-optimizations" title="Permalink to this heading"></a></h3>
<p>If the compilation errors were not due to
<a class="reference internal" href="#insufficient-memory"><span class="std std-ref">insufficient memory</span></a>, it may be that one or more
of the applied optimizations cause trouble. First, try compiling without link
time optimizations:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./concept<span class="w"> </span>--rebuild<span class="w"> </span>--linktime-optimizations<span class="w"> </span>False<span class="w"> </span>--local
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If this solves the problem, it may simply be because compilation without
LTO requires significantly less memory. You are encouraged to check if
you simply have <a class="reference internal" href="#insufficient-memory"><span class="std std-ref">insufficient memory</span></a> for a
fully optimized build.</p>
</div>
<p>If disabling link time optimizations makes the code compile, you may consider
this a working solution, as the performance improvements obtained through
link time optimizations are not crucial.</p>
<p>A much more drastic thing to try is to compile without <em>any</em> optimizations:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./concept<span class="w"> </span>--rebuild<span class="w"> </span>--optimizations<span class="w"> </span>False<span class="w"> </span>--local
</pre></div>
</div>
<p>If this works, the problem is definitely with some of the optimization flags.
You should however not run CO<em>N</em>CEPT simulations with the compiled code in
a completely unoptimized state, as this reduces performance drastically.
Instead, experiment with removing individual optimization flags added to the
<code class="docutils literal notranslate"><span class="pre">optimizations</span></code> and <code class="docutils literal notranslate"><span class="pre">optimizations_linker</span></code> variables within
<code class="docutils literal notranslate"><span class="pre">src/Makefile</span></code>. E.g. get rid of <code class="docutils literal notranslate"><span class="pre">-ffast-math</span></code> and/or <code class="docutils literal notranslate"><span class="pre">-funroll-loops</span></code>,
and/or substitute the <code class="docutils literal notranslate"><span class="pre">-O3</span></code> flag with <code class="docutils literal notranslate"><span class="pre">-O2</span></code>, then <code class="docutils literal notranslate"><span class="pre">-O1</span></code>, then <code class="docutils literal notranslate"><span class="pre">-O0</span></code>,
before removing it completely. For each attempt, recompile CO<em>N</em>CEPT
with<em>out</em> <code class="docutils literal notranslate"><span class="pre">--optimizations</span> <span class="pre">False</span></code>.</p>
</section>
</section>
<section id="terminal-colour-output-looks-weird">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Terminal colour output looks weird</a><a class="headerlink" href="#terminal-colour-output-looks-weird" title="Permalink to this heading"></a></h2>
<p>CO<em>N</em>CEPT includes a lot of colour and other formatting in its terminal
output. While most modern terminal emulators on Linux (GNOME Terminal,
Terminator, xterm, etc.) fully support this, the story is different on other
platforms.</p>
<ul>
<li><p><strong>Windows</strong>: If you are running CO<em>N</em>CEPT through the Windows subsystem
for Linux and the terminal formatting appears suboptimal, you can install a
modern Linux terminal within the Linux subsystem. Note that this requires a
running X server on the <em>Windows</em> side.</p>
<p>If you are running CO<em>N</em>CEPT from Windows locally through Docker or
remotely via SSH (through e.g. PuTTY), no solution is known.</p>
</li>
<li><p><strong>macOS</strong>: If you are running CO<em>N</em>CEPT from macOS (locally through
Docker or remotely via SSH) and the terminal formatting appears suboptimal,
try using the superior <a class="reference external" href="https://www.iterm2.com/">iTerm2</a> terminal emulator.</p></li>
</ul>
<p>If you want to disable colour and other
<a class="reference internal" href="parameters/graphics.html#enable-terminal-formatting"><span class="std std-ref">formatted output</span></a> altogether, set</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">enable_terminal_formatting</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>in your CO<em>N</em>CEPT parameter files. Note that though this eliminates most
formatting, a few elements are still formatted.</p>
</section>
<section id="problems-related-to-python-libraries-and-packages">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Problems related to Python libraries and packages</a><a class="headerlink" href="#problems-related-to-python-libraries-and-packages" title="Permalink to this heading"></a></h2>
<p>If Python itself fails to start or raises <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> when loading certain
packages, it may be due to improper configuration of the Python environment.
In particular the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>, <code class="docutils literal notranslate"><span class="pre">PYTHONHOME</span></code> and <code class="docutils literal notranslate"><span class="pre">PYTHONNOUSERSITE</span></code>
environment variables should be set (or unset) appropriately. If CO<em>N</em>CEPT
has its own dedicated Python installation, one safe choice is to follow
<a class="reference internal" href="installation.html#eliminating-interference-from-foreign-python-installations"><span class="std std-ref">this</span></a>,
which isolate the dedicated Python installation so that other Python
installations on the system has no chance of interfering.</p>
<p>Note that if you have installed CO<em>N</em>CEPT using the <code class="docutils literal notranslate"><span class="pre">install</span></code> script and
not explicitly made use of a pre-existing Python installation, a dedicated
Python has been installation and the Python environment has already been set
up appropriately (see the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file).</p>
</section>
<section id="error-messages-containing-read-1">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Error messages containing ‘Read -1’</a><a class="headerlink" href="#error-messages-containing-read-1" title="Permalink to this heading"></a></h2>
<p>If you see error messages of the form</p>
<blockquote>
<div><p>Read -1, expected &lt;int&gt;, errno = &lt;int&gt;</p>
</div></blockquote>
<p>whenever you run CO<em>N</em>CEPT using more than a single process, it is likely
a problem with OpenMPI, more specifically vader/CMA. If CO<em>N</em>CEPT
otherwise produces correct results, you can silence these messages by placing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_MCA_btl_vader_single_copy_mechanism</span><span class="o">=</span>none
</pre></div>
</div>
<p>in the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file of your CO<em>N</em>CEPT installation.</p>
</section>
<section id="clock-skew-and-or-modification-times-in-the-future">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Clock skew and/or modification times in the future</a><a class="headerlink" href="#clock-skew-and-or-modification-times-in-the-future" title="Permalink to this heading"></a></h2>
<p>If you receive warnings about clock skew and/or file modification times in the
future, it is likely a problem either with the system clock or the time stamps
of the CO<em>N</em>CEPT source files. Regardless, the problem — as far as it
pertains to CO<em>N</em>CEPT — is likely to go away if you update the time
stamps. To do so, run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>touch<span class="w"> </span>*<span class="w"> </span>src/*
</pre></div>
</div>
<p>from within the CO<em>N</em>CEPT installation directory.</p>
</section>
<section id="mixed-compiled-and-pure-python-mode">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Mixed compiled and pure Python mode</a><a class="headerlink" href="#mixed-compiled-and-pure-python-mode" title="Permalink to this heading"></a></h2>
<p>While technically possible, one never wants to run CO<em>N</em>CEPT in such a way
that some processes run in compiled mode (the default) while others run in
<a class="reference internal" href="command_line_options.html#pure-python"><span class="std std-ref">pure Python mode</span></a>. Such a mixed runtime state will be
detected and a warning will be emitted.</p>
<p>This can happen if only some processes have access to a CO<em>N</em>CEPT
<a class="reference internal" href="command_line_options.html#build"><span class="std std-ref">build</span></a>, while others have not and thus fall back to running
directly off of the Python source. This in turn may happen when running
multi-node CO<em>N</em>CEPT jobs on a cluster. If this is the case, make sure to
specify a <a class="reference internal" href="command_line_options.html#build"><span class="std std-ref">build</span></a> directory which is accessible from all nodes,
e.g. a directory within the CO<em>N</em>CEPT installation directory.</p>
</section>
<section id="the-simulation-hangs-when-calling-class">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">The simulation hangs when calling CLASS</a><a class="headerlink" href="#the-simulation-hangs-when-calling-class" title="Permalink to this heading"></a></h2>
<p>If the simulation hangs right at the beginning of the simulation, at the</p>
<blockquote>
<div><p>Calling CLASS in order to set the cosmic clock …</p>
</div></blockquote>
<p>step, it is probably because you have specified a cosmology that CLASS cannot
handle. When running CO<em>N</em>CEPT in compiled mode, CLASS may hang rather
than exiting with an error message. To see the CLASS error message, run
CO<em>N</em>CEPT in pure Python mode using the <code class="docutils literal notranslate"><span class="pre">--pure-python</span></code>
<a class="reference internal" href="command_line_options.html#pure-python"><span class="std std-ref">command-line option</span></a>.</p>
</section>
<section id="crashes-or-other-bad-behaviour">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Crashes or other bad behaviour</a><a class="headerlink" href="#crashes-or-other-bad-behaviour" title="Permalink to this heading"></a></h2>
<p>This entry is concerned with problems encountered when using CO<em>N</em>CEPT
<em>locally</em>. If your problem occurs only for remote jobs, please see the
‘<a class="reference internal" href="#id3">Problems when running remotely</a>’ entry instead.</p>
<p>If you are unable to even compile CO<em>N</em>CEPT, see the
‘<a class="reference internal" href="#compilation-failed">Compilation failed</a>’ entry.</p>
<p>If you are able to start CO<em>N</em>CEPT runs, but they crash, hang, yield
obviously wrong results, or exhibit other bad behaviour, it may be due to
improper installation or a code bug. To inspect the extent of the erroneous
behaviour, try running the full CO<em>N</em>CEPT test suite via</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./concept<span class="w"> </span>-t<span class="w"> </span>all
</pre></div>
</div>
<p>If any tests are unsuccessful and you are running an official version of
CO<em>N</em>CEPT (i.e. any release version or ‘master’), there is most probably
a problem with your installation. You can try reinstalling CO<em>N</em>CEPT along
with all of its dependencies, perhaps using compilers different from the ones
used the first time around.</p>
<p>If all tests pass despite the observed (and reproducible) bad behaviour, you
may have found a bug in a code path not covered by the test suite. Please
report this.</p>
</section>
<section id="problems-when-running-remotely">
<span id="id3"></span><h2><a class="toc-backref" href="#id14" role="doc-backlink">Problems when running remotely</a><a class="headerlink" href="#problems-when-running-remotely" title="Permalink to this heading"></a></h2>
<p>This entry is concerned with problems encountered specifically with remote
CO<em>N</em>CEPT jobs. If you have not tried out CO<em>N</em>CEPT locally, please do
this first. If you encounter problems here as well, please see the
‘<a class="reference internal" href="#crashes-or-other-bad-behaviour">Crashes or other bad behaviour</a>’ entry.</p>
<p>Even if CO<em>N</em>CEPT runs fine on the front-end of a cluster (i.e. when
supplying the <code class="docutils literal notranslate"><span class="pre">--local</span></code> option to the <code class="docutils literal notranslate"><span class="pre">concept</span></code> script), you may
experience weird behaviour or crashes when running remote jobs. Typically,
this is either due to an improper choice of the MPI executor, or the remote
nodes having different hardware architecture from the front-end. Possible
solutions to both of these problems are provided below.</p>
<section id="choosing-an-mpi-executor">
<span id="chosing-an-mpi-executor"></span><h3>Choosing an MPI executor<a class="headerlink" href="#choosing-an-mpi-executor" title="Permalink to this heading"></a></h3>
<p>It may help to manually choose a different remote <em>MPI executor</em>. This is the
term used for e.g. <code class="docutils literal notranslate"><span class="pre">mpiexec</span></code>/<code class="docutils literal notranslate"><span class="pre">mpirun</span></code> in CO<em>N</em>CEPT, i.e. the
executable used to launch MPI programs.</p>
<p>To see which MPI executor is used when running remotely, check out the
<code class="docutils literal notranslate"><span class="pre">mpi_executor</span></code> variable in the produced <code class="docutils literal notranslate"><span class="pre">job/&lt;ID&gt;/jobscript</span></code> file.
To manually set the MPI executor, overwrite the dedicated <code class="docutils literal notranslate"><span class="pre">mpi_executor</span></code>
variable in the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file. Helpful suggestions for the choice of MPI
executor depends on the job scheduler in use (Slurm or TORQUE/PBS).</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-0-U2x1cm0=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-U2x1cm0=" name="U2x1cm0=" role="tab" tabindex="0">Slurm</button><button aria-controls="panel-0-VE9SUVVFL1BCUw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-VE9SUVVFL1BCUw==" name="VE9SUVVFL1BCUw==" role="tab" tabindex="-1">TORQUE/PBS</button></div><div aria-labelledby="tab-0-U2x1cm0=" class="sphinx-tabs-panel group-tab" id="panel-0-U2x1cm0=" name="U2x1cm0=" role="tabpanel" tabindex="0"><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even if you are using Slurm, it may be that your MPI library is not
configured appropriately for <code class="docutils literal notranslate"><span class="pre">srun</span></code> to be able to correctly launch
MPI jobs. This can happen e.g. if you are using an MPI library that
was installed by the CO<em>N</em>CEPT <code class="docutils literal notranslate"><span class="pre">install</span></code> script, as opposed
to an
<a class="reference internal" href="installation.html#optimal-network-performance-on-clusters"><span class="std std-ref">MPI library configured and installed by a system administrator</span></a>
of the cluster. If the below does not work, try setting the MPI
executor as though you were using TORQUE/PBS.</p>
</div>
<p>If Slurm is used as the job scheduler and the MPI library used was not
installed by the <code class="docutils literal notranslate"><span class="pre">install</span></code> script as part of the CO<em>N</em>CEPT
installation, the MPI executor will be set to <code class="docutils literal notranslate"><span class="pre">srun</span> <span class="pre">--cpu-bind=none</span></code>
in job scripts by default (or possibly
<code class="docutils literal notranslate"><span class="pre">srun</span> <span class="pre">--cpu-bind=none</span> <span class="pre">--mpi=openmpi</span></code> if OpenMPI is used). The first
thing to try is to leave out <code class="docutils literal notranslate"><span class="pre">--cpu-bind=none</span></code>, i.e. setting</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">mpi_executor</span><span class="o">=</span><span class="s2">&quot;srun&quot;</span>
</pre></div>
</div>
<p>in the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file. Submit a new job, and you should see the manually
chosen MPI executor being respected by <code class="docutils literal notranslate"><span class="pre">job/&lt;ID&gt;/jobscript</span></code>.</p>
<p>If that did not fix the issue, try specifying the MPI implementation in
use, using the <code class="docutils literal notranslate"><span class="pre">--mpi</span></code> option to <code class="docutils literal notranslate"><span class="pre">srun</span></code>. E.g. for OpenMPI, set</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">mpi_executor</span><span class="o">=</span><span class="s2">&quot;srun --mpi=openmpi&quot;</span>
</pre></div>
</div>
<p>in the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file. To see which MPI implementations <code class="docutils literal notranslate"><span class="pre">srun</span></code>
supports, run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>srun<span class="w"> </span>--mpi<span class="o">=</span>list
</pre></div>
</div>
<p>directly on the front-end. You may wish to try your luck on all
supported MPI implementations. If you find one that works, do remember
to test if it also works with the added <code class="docutils literal notranslate"><span class="pre">--cpu-bind=none</span></code> option, as
this is preferred.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On some systems, the <code class="docutils literal notranslate"><span class="pre">--cpu-bind=none</span></code> option is written as
<code class="docutils literal notranslate"><span class="pre">--cpu_bind=none</span></code>, i.e. with an underscore. Try both.</p>
</div>
</div><div aria-labelledby="tab-0-VE9SUVVFL1BCUw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-VE9SUVVFL1BCUw==" name="VE9SUVVFL1BCUw==" role="tabpanel" tabindex="0"><p>When TORQUE or PBS is used as the job scheduler, the MPI executor will be
set to one of <code class="docutils literal notranslate"><span class="pre">mpiexec</span></code> or <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> by default, possibly with
additional options. The first thing to try is to leave out these options,
i.e. setting</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">mpi_executor</span><span class="o">=</span><span class="s2">&quot;mpiexec&quot;</span><span class="w">  </span><span class="c1"># or &quot;mpirun&quot;</span>
</pre></div>
</div>
<p>in the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file. Note that CO<em>N</em>CEPT sets the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> so that
<code class="docutils literal notranslate"><span class="pre">mpiexec</span></code>/<code class="docutils literal notranslate"><span class="pre">mpirun</span></code> are guaranteed to be those belonging to the
correct MPI implementation (that specified in the <code class="docutils literal notranslate"><span class="pre">.path</span></code> file). You
are however allowed to specify absolute paths as well.</p>
<p>An important option to try out with <code class="docutils literal notranslate"><span class="pre">mpiexec</span></code>/<code class="docutils literal notranslate"><span class="pre">mpirun</span></code> is</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">mpi_executor</span><span class="o">=</span><span class="s2">&quot;mpiexec --bind-to none&quot;</span><span class="w">  </span><span class="c1"># or &quot;mpirun --bind-to none&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On some systems, the <code class="docutils literal notranslate"><span class="pre">--bind-to</span> <span class="pre">none</span></code> options is written as
<code class="docutils literal notranslate"><span class="pre">-bind-to</span> <span class="pre">none</span></code>, i.e. with only one leading dash. Try both.</p>
</div>
<p>If remote jobs still fail, you may look for other possible MPI executors,
e.g. by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span><span class="nb">source</span><span class="w"> </span>concept<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>ls<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">mpi_bindir</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>(other possible MPI executors include <code class="docutils literal notranslate"><span class="pre">mpiexec.hydra</span></code> and <code class="docutils literal notranslate"><span class="pre">orterun</span></code>).</p>
</div></div>
</section>
<section id="different-hardware-architecture-on-front-end-and-remote-node">
<h3>Different hardware architecture on front-end and remote node<a class="headerlink" href="#different-hardware-architecture-on-front-end-and-remote-node" title="Permalink to this heading"></a></h3>
<p>If CO<em>N</em>CEPT and its dependencies have been installed from the front-end,
these have been somewhat tailored to the architecture of the front-end. If the
remote node to which you are submitting the CO<em>N</em>CEPT job has a different
architecture, things might go wrong. A trivial solution is then of course to
switch to using a different remote queue/partition with nodes that have
similar architecture to that of the front-end.</p>
<p>If you have installed CO<em>N</em>CEPT using the
<a class="reference internal" href="installation.html#standard-installation"><span class="std std-ref">standard installation process</span></a>, CO<em>N</em>CEPT
itself and all of its dependencies have been built in a somewhat portable
manner, meaning that CO<em>N</em>CEPT should run fine on architectures different
from that on the front-end, as long as they are not <em>too</em> different.</p>
<p>You may try rebuilding the CO<em>N</em>CEPT code from the remote node as part of
the submitted job, either by passing the <code class="docutils literal notranslate"><span class="pre">--rebuild</span></code> <a class="reference internal" href="command_line_options.html#rebuild"><span class="std std-ref">option</span></a>
to <code class="docutils literal notranslate"><span class="pre">concept</span></code> or supplying a new build directory with the
<code class="docutils literal notranslate"><span class="pre">-b</span></code> <a class="reference internal" href="command_line_options.html#build"><span class="std std-ref">option</span></a>.</p>
<p>Note that the supposed portability is severely limited if you build
CO<em>N</em>CEPT with the <code class="docutils literal notranslate"><span class="pre">--native-optimizations</span></code>
<a class="reference internal" href="command_line_options.html#native-optimizations"><span class="std std-ref">option</span></a>. To rebuild the code without additional
non-portable optimizations (default build), use the <code class="docutils literal notranslate"><span class="pre">--rebuild</span></code> option.</p>
<p>If rebuilding the code with only portable optimizations did not fix the
problem, it is worth submitting a remote CO<em>N</em>CEPT job without <em>any</em>
optimizations via the <code class="docutils literal notranslate"><span class="pre">--optimizations</span> <span class="pre">False</span></code> <a class="reference internal" href="command_line_options.html#optimizations"><span class="std std-ref">option</span></a>
to the <code class="docutils literal notranslate"><span class="pre">concept</span></code> script, just to see what happens. Remember to also supply
<code class="docutils literal notranslate"><span class="pre">--rebuild</span></code> to force recompilation. If this works, you should experiment
with <code class="docutils literal notranslate"><span class="pre">src/Makefile</span></code> as described <a class="reference internal" href="#dangerous-optimizations"><span class="std std-ref">here</span></a>,
as running in a completely unoptimized state is far from ideal.</p>
<p>To fully ensure compatibility with the architecture of a given node, you may
reinstall CO<em>N</em>CEPT — including all of its dependencies — from that
node. You may either do this by <code class="docutils literal notranslate"><span class="pre">ssh</span></code>’ing into the node and run the
installation manually, or you may submit the installation as a remote job.
Below you will find examples of Slurm and TORQUE/PBS job scripts for
installing CO<em>N</em>CEPT. In both cases you may wish to change
<code class="docutils literal notranslate"><span class="pre">concept_version</span></code> and <code class="docutils literal notranslate"><span class="pre">install_dir</span></code>, load modules or perform other
environment changes, and/or make use of a pre-installed MPI library as
described <a class="reference internal" href="installation.html#optimal-network-performance-on-clusters"><span class="std std-ref">here</span></a>.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-1-U2x1cm0=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-U2x1cm0=" name="U2x1cm0=" role="tab" tabindex="0">Slurm</button><button aria-controls="panel-1-VE9SUVVFL1BCUw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-VE9SUVVFL1BCUw==" name="VE9SUVVFL1BCUw==" role="tab" tabindex="-1">TORQUE/PBS</button></div><div aria-labelledby="tab-1-U2x1cm0=" class="sphinx-tabs-panel group-tab" id="panel-1-U2x1cm0=" name="U2x1cm0=" role="tabpanel" tabindex="0"><p>An example Slurm job script for installing CO<em>N</em>CEPT is shown below.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>
<span class="c1">#SBATCH --job-name=install_concept</span>
<span class="c1">#SBATCH --partition=&lt;queue&gt;</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --tasks-per-node=8</span>
<span class="c1">#SBATCH --mem-per-cpu=2000M</span>
<span class="c1">#SBATCH --time=12:00:00</span>
<span class="c1">#SBATCH --output=/dev/null</span>
<span class="c1">#SBATCH --error=/dev/null</span>

<span class="nv">concept_version</span><span class="o">=</span>v1.0.1
<span class="nv">install_dir</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/concept&quot;</span>

<span class="nv">install_url</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/jmd-dk/concept/</span><span class="si">${</span><span class="nv">concept_version</span><span class="si">}</span><span class="s2">/install&quot;</span>
<span class="nv">make_jobs</span><span class="o">=</span><span class="s2">&quot;-j 8&quot;</span><span class="w"> </span>bash<span class="w"> </span>&lt;<span class="o">(</span>wget<span class="w"> </span>-O-<span class="w"> </span>--no-check-certificate<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">install_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">install_dir</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>To use this installation job script, save its content to e.g.
<code class="docutils literal notranslate"><span class="pre">jobscript_install</span></code> (replacing <code class="docutils literal notranslate"><span class="pre">&lt;queue&gt;</span></code> with the queue/partition
in question) and submit it using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbatch<span class="w"> </span>jobscript_install
</pre></div>
</div>
</div><div aria-labelledby="tab-1-VE9SUVVFL1BCUw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-VE9SUVVFL1BCUw==" name="VE9SUVVFL1BCUw==" role="tabpanel" tabindex="0"><p>An example TORQUE/PBS job script for installing CO<em>N</em>CEPT is
shown below.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>
<span class="c1">#PBS -N install_concept</span>
<span class="c1">#PBS -q &lt;queue&gt;</span>
<span class="c1">#PBS -l nodes=1:ppn=8</span>
<span class="c1">#PBS -l walltime=12:00:00</span>
<span class="c1">#PBS -o /dev/null</span>
<span class="c1">#PBS -e /dev/null</span>

<span class="nv">concept_version</span><span class="o">=</span>v1.0.1
<span class="nv">install_dir</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/concept&quot;</span>

<span class="nv">install_url</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/jmd-dk/concept/</span><span class="si">${</span><span class="nv">concept_version</span><span class="si">}</span><span class="s2">/install&quot;</span>
<span class="nv">make_jobs</span><span class="o">=</span><span class="s2">&quot;-j 8&quot;</span><span class="w"> </span>bash<span class="w"> </span>&lt;<span class="o">(</span>wget<span class="w"> </span>-O-<span class="w"> </span>--no-check-certificate<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">install_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">install_dir</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>To use this installation job script, save its content to e.g.
<code class="docutils literal notranslate"><span class="pre">jobscript_install</span></code> (replacing <code class="docutils literal notranslate"><span class="pre">&lt;queue&gt;</span></code> with the queue in question)
and submit it using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qsub<span class="w"> </span>jobscript_install
</pre></div>
</div>
</div></div>
<p>Once a CO<em>N</em>CEPT installation job has begun, you can follow the
installation process by executing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tail<span class="w"> </span>-f<span class="w"> </span>&lt;install_dir&gt;/.tmp/install_log
</pre></div>
</div>
</section>
<section id="it-still-does-not-work">
<h3>It <em>still</em> does not work!<a class="headerlink" href="#it-still-does-not-work" title="Permalink to this heading"></a></h3>
<p>If you are still struggling, in particular if CO<em>N</em>CEPT does launch but
the MPI process binding/affinity is wrong, try removing some of the added
environment variables that gets set in <code class="docutils literal notranslate"><span class="pre">job/&lt;ID&gt;/jobscript</span></code> (under the
‘Environment variables’ heading). After altering the job script, submit it
manually using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbatch<span class="w"> </span>job/&lt;ID&gt;/jobscript<span class="w">  </span><span class="c1"># Slurm</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qsub<span class="w"> </span>job/&lt;ID&gt;/jobscript<span class="w">  </span><span class="c1"># TORQUE/PBS</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When manually submitting an auto-generated job script, a subdirectory
within the <code class="docutils literal notranslate"><span class="pre">job</span></code> directory will be created for the new job, just as when
a job is auto-submitted via the <code class="docutils literal notranslate"><span class="pre">concept</span></code> script. This subdirectory can
take a minute to appear though.</p>
</div>
<p>It is also possible that the cluster configuration just does not play nicely
with the current MPI implementation in use. If you installed CO<em>N</em>CEPT
using one of the MPI implementations present on the cluster, try again, using
another pre-installed MPI library. If you instead let CO<em>N</em>CEPT install
its own MPI, try switching from MPICH to OpenMPI or vice versa, as described
<a class="reference internal" href="installation.html#installing-mpich-or-openmpi"><span class="std std-ref">here</span></a>.</p>
<p>When installing CO<em>N</em>CEPT, try having as few environment modules loaded
as possible, in order to minimize the possibility of wrong MPI identification
and linking. In particular, beware of environment modules loaded and variables
set automatically in files like <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> and <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code>.</p>
</section>
</section>
<section id="bad-performance-when-using-multiple-processes-nodes">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Bad performance when using multiple processes/nodes</a><a class="headerlink" href="#bad-performance-when-using-multiple-processes-nodes" title="Permalink to this heading"></a></h2>
<p>If you are running CO<em>N</em>CEPT on a cluster and experience a significant
drop in performance as you increase the number of processes from e.g. 1 to 2
or 2 to 4, or when using 2 nodes instead of 1 with the same total number of
processes, the problem is likely that the MPI library used is not configured
to handle the network optimally.</p>
<p>Be sure to install CO<em>N</em>CEPT with
<a class="reference internal" href="installation.html#optimal-network-performance-on-clusters"><span class="std std-ref">optimal network performance on clusters</span></a>.
If you are observing bad network behaviour even so, you should try changing
the MPI executor, as described <a class="reference internal" href="#chosing-an-mpi-executor"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="problems-when-using-multiple-nodes">
<span id="id4"></span><h2><a class="toc-backref" href="#id16" role="doc-backlink">Problems when using multiple nodes</a><a class="headerlink" href="#problems-when-using-multiple-nodes" title="Permalink to this heading"></a></h2>
<p>If you observe a wrong process binding (i.e. it appears as though several
copies of CO<em>N</em>CEPT are running on top of each other, rather than all of
the MPI processes working together as a collective) when running CO<em>N</em>CEPT
across multiple nodes, you should try
<a class="reference internal" href="#chosing-an-mpi-executor"><span class="std std-ref">changing the MPI executor</span></a>.</p>
<p>If you are able to run single-node CO<em>N</em>CEPT jobs remotely, but encounter
problems as soon as you request multiple nodes, it may be a permission
problem. For example, OpenMPI uses SSH to establish the connection between the
nodes, and so your local <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code> directory need to be configured properly.
Note that when using an MPI implementation pre-installed on the cluster, such
additional configuration from the user ought not be necessary.</p>
<p>CO<em>N</em>CEPT comes with the ability to set up the <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code> as needed for
multi-node communication. Currently this feature resides as part of the
<code class="docutils literal notranslate"><span class="pre">install</span></code> script. To apply it, execute</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./install<span class="w"> </span>--fix-ssh
</pre></div>
</div>
<p>from the CO<em>N</em>CEPT installation directory.</p>
<p>Note that this will move all existing content of <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code> to
<code class="docutils literal notranslate"><span class="pre">~/.ssh_backup</span></code>. Also, any configuration you might have done will not be
reflected in the new content of <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code>. If this indeed fixes the
multi-node problem and you want to preserve your original SSH configuration,
you must properly merge the original content of <code class="docutils literal notranslate"><span class="pre">~/.ssh_backup</span></code> back in with
the new content of <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">


    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>